<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Session 02 &mdash; Internet Programming with Python</title>
    
    <link rel="stylesheet" href="../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Internet Programming with Python" href="../index.html" />
    <link rel="up" title="Course Presentations" href="index.html" />
    <link rel="next" title="Session 03" href="session03.html" />
    <link rel="prev" title="Session 01" href="session01.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header">
  <div class="logo">
    <a href="../index.html">
      <img class="logo" src="../_static/logo_UW.png" alt="Logo"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="session03.html" title="Session 03"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="session01.html" title="Session 01"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">UWPCE Python 200</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Course Presentations</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="session-02">
<h1>Session 02<a class="headerlink" href="#session-02" title="Permalink to this headline">¶</a></h1>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../_images/protocol.png"><img alt="../_images/protocol.png" src="../_images/protocol.png" style="width: 40%;" /></a>
<p class="caption"><span class="caption-text">Web Protocols</span></p>
</div>
<div class="section" id="the-languages-computers-speak">
<h2>The Languages Computers Speak<a class="headerlink" href="#the-languages-computers-speak" title="Permalink to this headline">¶</a></h2>
<div class="build left container">
<p>Programming languages like Python are the languages we speak to computers.</p>
<p><em>Protocols</em> are the languages that computers speak to each-other.</p>
<p>This sesson we&#8217;ll look at a few of them and</p>
<ul class="build simple">
<li>Learn what makes them similar</li>
<li>Learn what makes them different</li>
<li>Learn about Python&#8217;s tools for speaking them</li>
<li>Learn how to speak one (HTTP) ourselves</li>
</ul>
</div>
<div class="section" id="but-first">
<h3>But First<a class="headerlink" href="#but-first" title="Permalink to this headline">¶</a></h3>
<p class="large centered">Questions from the Homework?</p>
<p class="large centered">Examples of an echo server using <code class="docutils literal"><span class="pre">select</span></code></p>
</div>
<div class="section" id="what-is-a-protocol">
<h3>What is a Protocol?<a class="headerlink" href="#what-is-a-protocol" title="Permalink to this headline">¶</a></h3>
<div class="build large centered container">
<p><strong>a set of rules or conventions</strong></p>
<p><strong>governing communications</strong></p>
</div>
<p>Life has lots of sets of rules for how to do things.</p>
<ul class="build simple">
<li>What do you say when you get on the elevator?</li>
<li>What do you do on a first date?</li>
<li>What do you wear to a job interview?</li>
<li>What do (and don&#8217;t) you talk about at a dinner party?</li>
<li>...?</li>
</ul>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../_images/icup.png"><img alt="../_images/icup.png" src="../_images/icup.png" style="width: 65%;" /></a>
<p class="caption"><span class="caption-text"><a class="reference external" href="http://blog.xkcd.com/2009/09/02/urinal-protocol-vulnerability/">http://blog.xkcd.com/2009/09/02/urinal-protocol-vulnerability/</a></span></p>
</div>
<p>Digital life has lots of rules too:</p>
<ul class="build simple">
<li>how to say hello</li>
<li>how to identify yourself</li>
<li>how to ask for information</li>
<li>how to provide answers</li>
<li>how to say goodbye</li>
</ul>
</div>
<div class="section" id="real-protocol-examples">
<h3>Real Protocol Examples<a class="headerlink" href="#real-protocol-examples" title="Permalink to this headline">¶</a></h3>
<p>What does this look like in practice?</p>
<ul class="build simple">
<li>SMTP (Simple Message Transfer Protocol) <br />
<a class="reference external" href="http://tools.ietf.org/html/rfc5321#appendix-D">http://tools.ietf.org/html/rfc5321#appendix-D</a></li>
<li>POP3 (Post Office Protocol) <br />
<a class="reference external" href="http://www.faqs.org/docs/artu/ch05s03.html">http://www.faqs.org/docs/artu/ch05s03.html</a></li>
<li>IMAP (Internet Message Access Protocol) <br />
<a class="reference external" href="http://www.faqs.org/docs/artu/ch05s03.html">http://www.faqs.org/docs/artu/ch05s03.html</a></li>
<li>HTTP (Hyper-Text Transfer Protocol) <br />
<a class="reference external" href="http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol</a></li>
</ul>
<p>Over the next few slides we&#8217;ll be looking at server/client interactions.</p>
<div class="build container">
<p>Each interaction is line-based, each line represents one message.</p>
<p>Messages from the Server to the Client are prefaced with <code class="docutils literal"><span class="pre">S</span> <span class="pre">(&lt;--)</span></code></p>
<p>Messages from the Client to the Server are prefaced with <code class="docutils literal"><span class="pre">C</span> <span class="pre">(--&gt;)</span></code></p>
<p><strong>All</strong> lines end with the character sequence <code class="docutils literal"><span class="pre">&lt;CRLF&gt;</span></code> (<code class="docutils literal"><span class="pre">\r\n</span></code>)</p>
</div>
</div>
<div class="section" id="smtp">
<h3>SMTP<a class="headerlink" href="#smtp" title="Permalink to this headline">¶</a></h3>
<p>What does SMTP look like?</p>
<div class="build container">
<p>SMTP (Say hello and identify yourself):</p>
<div class="highlight-python"><div class="highlight"><pre>S (&lt;--): 220 foo.com Simple Mail Transfer Service Ready
C (--&gt;): EHLO bar.com
S (&lt;--): 250-foo.com greets bar.com
S (&lt;--): 250-8BITMIME
S (&lt;--): 250-SIZE
S (&lt;--): 250-DSN
S (&lt;--): 250 HELP
</pre></div>
</div>
</div>
<p>SMTP (Ask for information, provide answers):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): MAIL FROM:&lt;Smith@bar.com&gt;
S (&lt;--): 250 OK
C (--&gt;): RCPT TO:&lt;Jones@foo.com&gt;
S (&lt;--): 250 OK
C (--&gt;): RCPT TO:&lt;Green@foo.com&gt;
S (&lt;--): 550 No such user here
C (--&gt;): DATA
S (&lt;--): 354 Start mail input; end with &lt;CRLF&gt;.&lt;CRLF&gt;
C (--&gt;): Blah blah blah...
C (--&gt;): ...etc. etc. etc.
C (--&gt;): .
S (&lt;--): 250 OK
</pre></div>
</div>
<p>SMTP (Say goodbye):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): QUIT
S (&lt;--): 221 foo.com Service closing transmission channel
</pre></div>
</div>
<ul class="build simple">
<li>Interaction consists of commands and replies</li>
<li>Each command or reply is <em>one line</em> terminated by &lt;CRLF&gt; <br />
(there are exceptions, see the <code class="docutils literal"><span class="pre">250</span></code> reply to <code class="docutils literal"><span class="pre">EHLO</span></code> above)</li>
<li>The exception is message payload, terminated by &lt;CRLF&gt;.&lt;CRLF&gt;</li>
<li>Each command has a <em>verb</em> and one or more <em>arguments</em></li>
<li>Each reply has a formal <em>code</em> and an informal <em>explanation</em></li>
</ul>
</div>
<div class="section" id="pop3">
<h3>POP3<a class="headerlink" href="#pop3" title="Permalink to this headline">¶</a></h3>
<p>What does POP3 look like?</p>
<div class="build container">
<p>POP3 (Say hello and identify yourself):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): &lt;client connects to service port 110&gt;
S (&lt;--): +OK POP3 server ready &lt;1896.6971@mailgate.dobbs.org&gt;
C (--&gt;): USER bob
S (&lt;--): +OK bob
C (--&gt;): PASS redqueen
S (&lt;--): +OK bob&#39;s maildrop has 2 messages (320 octets)
</pre></div>
</div>
</div>
<p>POP3 (Ask for information, provide answers):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): STAT
S (&lt;--): +OK 2 320
C (--&gt;): LIST
S (&lt;--): +OK 1 messages (120 octets)
S (&lt;--): 1 120
S (&lt;--): .
</pre></div>
</div>
<p>POP3 (Ask for information, provide answers):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): RETR 1
S (&lt;--): +OK 120 octets
S (&lt;--): &lt;server sends the text of message 1&gt;
S (&lt;--): .
C (--&gt;): DELE 1
S (&lt;--): +OK message 1 deleted
</pre></div>
</div>
<p>POP3 (Say goodbye):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): QUIT
S (&lt;--): +OK dewey POP3 server signing off (maildrop empty)
C (--&gt;): &lt;client hangs up&gt;
</pre></div>
</div>
<div class="build container">
<ul class="build simple">
<li>Interaction consists of commands and replies</li>
<li>Each command or reply is <em>one line</em> terminated by &lt;CRLF&gt;</li>
<li>The exception is message payload, terminated by &lt;CRLF&gt;.&lt;CRLF&gt;</li>
<li>Each command has a <em>verb</em> and one or more <em>arguments</em></li>
<li>Each reply has a formal <em>code</em> and an informal <em>explanation</em></li>
</ul>
<p>The codes don&#8217;t really look the same, though, do they?</p>
</div>
<p>The exception to the one-line-per-message rule is <em>payload</em></p>
<div class="build container">
<p>In both SMTP and POP3 this is terminated by &lt;CRLF&gt;.&lt;CRLF&gt;</p>
<p>In SMTP, the <em>client</em> has this ability</p>
<p>But in POP3, it belongs to the <em>server</em>.</p>
<p class="large centered">Why?</p>
</div>
</div>
<div class="section" id="imap">
<h3>IMAP<a class="headerlink" href="#imap" title="Permalink to this headline">¶</a></h3>
<p>What does IMAP look like?</p>
<div class="build container">
<p>IMAP (Say hello and identify yourself):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): &lt;client connects to service port 143&gt;
S (&lt;--): * OK example.com IMAP4rev1 v12.264 server ready
C (--&gt;): A0001 USER &quot;frobozz&quot; &quot;xyzzy&quot;
S (&lt;--): * OK User frobozz authenticated
</pre></div>
</div>
</div>
<p>IMAP (Ask for information, provide answers [connect to an inbox]):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): A0002 SELECT INBOX
S (&lt;--): * 1 EXISTS
S (&lt;--): * 1 RECENT
S (&lt;--): * FLAGS (\Answered \Flagged \Deleted \Draft \Seen)
S (&lt;--): * OK [UNSEEN 1] first unseen message in /var/spool/mail/esr
S (&lt;--): A0002 OK [READ-WRITE] SELECT completed
</pre></div>
</div>
<p>IMAP (Ask for information, provide answers [Get message sizes]):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): A0003 FETCH 1 RFC822.SIZE
S (&lt;--): * 1 FETCH (RFC822.SIZE 2545)
S (&lt;--): A0003 OK FETCH completed
</pre></div>
</div>
<p>IMAP (Ask for information, provide answers [Get first message header]):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): A0004 FETCH 1 BODY[HEADER]
S (&lt;--): * 1 FETCH (RFC822.HEADER {1425}
&lt;server sends 1425 octets of message payload&gt;
S (&lt;--): )
S (&lt;--): A0004 OK FETCH completed
</pre></div>
</div>
<p>IMAP (Ask for information, provide answers [Get first message body]):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): A0005 FETCH 1 BODY[TEXT]
S (&lt;--): * 1 FETCH (BODY[TEXT] {1120}
&lt;server sends 1120 octets of message payload&gt;
S (&lt;--): )
S (&lt;--): * 1 FETCH (FLAGS (\Recent \Seen))
S (&lt;--): A0005 OK FETCH completed
</pre></div>
</div>
<p>IMAP (Say goodbye):</p>
<div class="highlight-python"><div class="highlight"><pre>C (--&gt;): A0006 LOGOUT
S (&lt;--): * BYE example.com IMAP4rev1 server terminating connection
S (&lt;--): A0006 OK LOGOUT completed
C (--&gt;): &lt;client hangs up&gt;
</pre></div>
</div>
<ul class="build simple">
<li>Interaction consists of commands and replies</li>
<li>Each command or reply is <em>one line</em> terminated by &lt;CRLF&gt;</li>
<li>Each command has a <em>verb</em> and one or more <em>arguments</em></li>
<li>Each reply has a formal <em>code</em> and an informal <em>explanation</em></li>
</ul>
<div class="build container">
<ul class="build simple">
<li>Commands and replies are prefixed by &#8216;sequence identifier&#8217;</li>
<li>Payloads are prefixed by message size, rather than terminated by reserved
sequence</li>
</ul>
<p>Compared with POP3, what do these differences suggest?</p>
</div>
</div>
<div class="section" id="using-imap-in-python">
<h3>Using IMAP in Python<a class="headerlink" href="#using-imap-in-python" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s try this out for ourselves!</p>
<div class="build container">
<div class="container">
Fire up your python interpreters and prepare to type.</div>
</div>
<p>Begin by importing the <code class="docutils literal"><span class="pre">imaplib</span></code> module from the Python Standard Library:</p>
<div class="build container">
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">imaplib</span>
<span class="gp">In [2]: </span><span class="nb">dir</span><span class="p">(</span><span class="n">imaplib</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">[&#39;AllowedVersions&#39;,</span>
<span class="go"> &#39;CRLF&#39;,</span>
<span class="go"> &#39;Commands&#39;,</span>
<span class="go">...</span>
<span class="go"> &#39;timedelta&#39;,</span>
<span class="go"> &#39;timezone&#39;]</span>
<span class="gp">In [3]: </span><span class="n">imaplib</span><span class="o">.</span><span class="n">Debug</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Setting <code class="docutils literal"><span class="pre">imap.Debug</span></code> shows us what is sent and received</p>
</div>
<p>I&#8217;ve prepared a server for us to use, but we&#8217;ll need to set up a client to
speak to it.</p>
<div class="build container">
<p>Our server requires SSL (Secure Socket Layer) for connecting to IMAP
servers, so let&#8217;s initialize an IMAP4_SSL client and authenticate:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [4]: </span><span class="n">conn</span> <span class="o">=</span> <span class="n">imaplib</span><span class="o">.</span><span class="n">IMAP4_SSL</span><span class="p">(</span><span class="s">&#39;mail.webfaction.com&#39;</span><span class="p">)</span>
<span class="go">  22:40.32 imaplib version 2.58</span>
<span class="go">  22:40.32 new IMAP4 connection, tag=b&#39;IMKC&#39;</span>
<span class="go">  22:40.38 &lt; b&#39;* OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN] Dovecot ready.&#39;</span>
<span class="go">  22:40.38 &gt; b&#39;IMKC0 CAPABILITY&#39;</span>
<span class="go">  22:40.45 &lt; b&#39;* CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN&#39;</span>
<span class="go">  22:40.45 &lt; b&#39;IMKC0 OK Capability completed.&#39;</span>
<span class="go">  22:40.45 CAPABILITIES: (&#39;IMAP4REV1&#39;, &#39;LITERAL+&#39;, &#39;SASL-IR&#39;, &#39;LOGIN-REFERRALS&#39;, &#39;ID&#39;, &#39;ENABLE&#39;, &#39;IDLE&#39;, &#39;AUTH=PLAIN&#39;)</span>
<span class="gp">In [5]: </span><span class="n">conn</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s">&#39;crisewing_demobox&#39;</span><span class="p">,</span> <span class="s">&#39;s00p3rs3cr3t&#39;</span><span class="p">)</span>
<span class="go">  22:59.92 &gt; b&#39;IMKC1 LOGIN crisewing_demobox &quot;s00p3rs3cr3t&quot;&#39;</span>
<span class="go">  23:01.79 &lt; b&#39;* CAPABILITY IMAP4rev1 SASL-IR SORT THREAD=REFERENCES MULTIAPPEND UNSELECT LITERAL+ IDLE CHILDREN NAMESPACE LOGIN-REFERRALS STARTTLS AUTH=PLAIN&#39;</span>
<span class="go">  23:01.79 &lt; b&#39;IMKC1 OK Logged in.&#39;</span>
<span class="gh">Out[5]: </span><span class="go">(&#39;OK&#39;, [b&#39;Logged in.&#39;])</span>
</pre></div>
</div>
</div>
<p>We can start by listing the mailboxes we have on the server:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [6]: </span><span class="n">conn</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">  26:30.64 &gt; b&#39;IMKC2 LIST &quot;&quot; *&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;Trash&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;Drafts&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;Sent&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;Junk&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;INBOX&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;IMKC2 OK List completed.&#39;</span>
<span class="gh">Out[6]:</span>
<span class="go">(&#39;OK&#39;,</span>
<span class="go"> [b&#39;(\\HasNoChildren) &quot;.&quot; &quot;Trash&quot;&#39;,</span>
<span class="go">  b&#39;(\\HasNoChildren) &quot;.&quot; &quot;Drafts&quot;&#39;,</span>
<span class="go">  b&#39;(\\HasNoChildren) &quot;.&quot; &quot;Sent&quot;&#39;,</span>
<span class="go">  b&#39;(\\HasNoChildren) &quot;.&quot; &quot;Junk&quot;&#39;,</span>
<span class="go">  b&#39;(\\HasNoChildren) &quot;.&quot; &quot;INBOX&quot;&#39;])</span>
</pre></div>
</div>
<p>To interact with our email, we must select a mailbox from the list we received
earlier:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [7]: </span><span class="n">conn</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&#39;INBOX&#39;</span><span class="p">)</span>
<span class="go">  27:20.96 &gt; b&#39;IMKC3 SELECT INBOX&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft)&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* OK [PERMANENTFLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft \\*)] Flags permitted.&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* 1 EXISTS&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* 0 RECENT&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* OK [UNSEEN 1] First unseen.&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* OK [UIDVALIDITY 1357449499] UIDs valid&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* OK [UIDNEXT 24] Predicted next UID&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;IMKC3 OK [READ-WRITE] Select completed.&#39;</span>
<span class="gh">Out[7]: </span><span class="go">(&#39;OK&#39;, [b&#39;1&#39;])</span>
</pre></div>
</div>
<p>We can search our selected mailbox for messages matching one or more criteria.</p>
<div class="build container">
<p>The return value is a list of bytestrings containing the UIDs of messages
that match our search:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [8]: </span><span class="n">conn</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">&#39;(FROM &quot;cris&quot;)&#39;</span><span class="p">)</span>
<span class="go">  28:43.02 &gt; b&#39;IMKC4 SEARCH (FROM &quot;cris&quot;)&#39;</span>
<span class="go">  28:43.09 &lt; b&#39;* SEARCH 1&#39;</span>
<span class="go">  28:43.09 &lt; b&#39;IMKC4 OK Search completed.&#39;</span>
<span class="gh">Out[8]: </span><span class="go">(&#39;OK&#39;, [b&#39;1&#39;])</span>
</pre></div>
</div>
</div>
<p>Once we&#8217;ve found a message we want to look at, we can use the <code class="docutils literal"><span class="pre">fetch</span></code>
command to read it from the server.</p>
<div class="build container">
<p>IMAP allows fetching each part of a message independently:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [9]: </span><span class="n">conn</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;BODY[HEADER]&#39;</span><span class="p">)</span>
<span class="go">  ...</span>
<span class="gh">Out[9]: </span><span class="go">(&#39;OK&#39;, ...)</span>

<span class="gp">In [10]: </span><span class="n">conn</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;FLAGS&#39;</span><span class="p">)</span>
<span class="go">  ...</span>
<span class="gh">Out[10]: </span><span class="go">(&#39;OK&#39;, [b&#39;1 (FLAGS (\\Seen))&#39;])</span>

<span class="gp">In [11]: </span><span class="n">conn</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;BODY[TEXT]&#39;</span><span class="p">)</span>
<span class="go">  ...</span>
<span class="gh">Out[11]: </span><span class="go">(&#39;OK&#39;, ...)</span>
</pre></div>
</div>
<p>What does the message say?</p>
</div>
<p>Python even includes an <em>email</em> library that would allow us to interact with
this message in an <em>OO</em> style.</p>
<div class="build container">
<em>Neat, Huh?</em></div>
</div>
<div class="section" id="what-have-we-learned">
<h3>What Have We Learned?<a class="headerlink" href="#what-have-we-learned" title="Permalink to this headline">¶</a></h3>
<div class="build container">
<ul class="build simple">
<li>Protocols are just a set of rules for how to communicate</li>
<li>Protocols tell us how to parse and delimit messages</li>
<li>Protocols tell us what messages are valid</li>
<li>If we properly format request messages to a server, we can get response
messages</li>
<li>Python supports a number of these protocols</li>
<li>So we don&#8217;t have to remember how to format the commands ourselves</li>
</ul>
<p>But in every case we&#8217;ve seen, we could do the same thing with a socket and
some strings</p>
</div>
</div>
<div class="section" id="break-time">
<h3>Break Time<a class="headerlink" href="#break-time" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s take a few minutes here to clear our heads.</p>
<div class="build container">
<p>When we return, we&#8217;ll learn about the king of protocols,</p>
<p class="large centered">HTTP</p>
</div>
</div>
</div>
<div class="section" id="http">
<h2>HTTP<a class="headerlink" href="#http" title="Permalink to this headline">¶</a></h2>
<div class="left container">
<p>HTTP is no different</p>
<div class="build container">
<p>HTTP is also message-centered, with two-way communications:</p>
<ul class="build simple">
<li>Requests (Asking for information)</li>
<li>Responses (Providing answers)</li>
</ul>
</div>
</div>
<div class="section" id="what-does-http-look-like">
<h3>What does HTTP look like?<a class="headerlink" href="#what-does-http-look-like" title="Permalink to this headline">¶</a></h3>
<p>HTTP (Ask for information):</p>
<div class="highlight-http"><div class="highlight"><pre>GET /index.html HTTP/1.1&lt;CRLF&gt;
Host: www.example.com&lt;CRLF&gt;
&lt;CRLF&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the <code class="docutils literal"><span class="pre">&lt;CRLF&gt;</span></code> you see here is a visualization of the <code class="docutils literal"><span class="pre">\r\n</span></code>
character sequence.</p>
</div>
<p>HTTP (Provide answers):</p>
<div class="highlight-http"><div class="highlight"><pre>HTTP/1.1 200 OK
Date: Mon, 23 May 2005 22:38:34 GMT
Server: Apache/1.3.3.7 (Unix) (Red-Hat/Linux)
Last-Modified: Wed, 08 Jan 2003 23:11:55 GMT
Etag: &quot;3f80f-1b6-3e1cb03b&quot;
Accept-Ranges:  none
Content-Length: 438
Connection: close
Content-Type: text/html; charset=UTF-8
&lt;CRLF&gt;
&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;This is a .... &lt;/html&gt;
</pre></div>
</div>
<p>Pay particular attention to the <code class="docutils literal"><span class="pre">&lt;CRLF&gt;</span></code> on a line by itself.</p>
<p>In HTTP, both <em>request</em> and <em>response</em> share a common basic format:</p>
<ul class="build simple">
<li>Line separators are &lt;CRLF&gt; (familiar, no?)</li>
<li>A required initial line (a command or a response code)</li>
<li>A (mostly) optional set of headers, one per line</li>
<li>A blank line</li>
<li>An optional body</li>
</ul>
</div>
<div class="section" id="implementing-http">
<h3>Implementing HTTP<a class="headerlink" href="#implementing-http" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s investigate the HTTP protocol a bit in real life.</p>
<div class="build container">
<p>We&#8217;ll do so by building a simplified HTTP server, one step at a time.</p>
<p>There is a copy of the echo server from last time in
<code class="docutils literal"><span class="pre">resources/session02</span></code>. It&#8217;s called <code class="docutils literal"><span class="pre">http_server.py</span></code>.</p>
<p>In a terminal, move into that directory. We&#8217;ll be doing our work here for
the rest of the session</p>
</div>
<p>Test Driven Development (TDD) is all the rage these days.</p>
<div class="build container">
<p>It means that before you write code, you first write tests demonstrating
what you want your code to do.</p>
<p>When all your tests pass, you are finished. You did this for your last
assignment.</p>
<p>We&#8217;ll be doing it again today.</p>
</div>
<p>From inside <code class="docutils literal"><span class="pre">resources/session02</span></code> start a second python interpreter and run
<code class="docutils literal"><span class="pre">$</span> <span class="pre">python</span> <span class="pre">http_server.py</span></code></p>
<div class="build container">
<p>In your first interpreter run the tests. You should see similar output:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python tests.py
<span class="o">[</span>...<span class="o">]</span>
Ran <span class="m">10</span> tests in 0.054s

FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span>3, <span class="nv">errors</span><span class="o">=</span>7<span class="o">)</span>
</pre></div>
</div>
<p>Let&#8217;s take a few minutes here to look at these tests and understand them.</p>
</div>
<p>Our job is to make all those tests pass.</p>
<div class="build container">
<p>First, though, let&#8217;s pretend this server really is a functional HTTP
server.</p>
<p>This time, instead of using the echo client to make a connection to the
server, let&#8217;s use a web browser!</p>
<p>Point your favorite browser at <code class="docutils literal"><span class="pre">http://localhost:10000</span></code></p>
</div>
<p>First, look at the printed output from your echo server.</p>
<div class="build container">
<p>Second, note that your browser is still waiting to finish loading the page</p>
<p>Moreover, your server should also be hung, waiting for more from the
&#8216;client&#8217;</p>
<p>This is because the server is waiting for the browser to respond</p>
<p>And at the same time, the browser is waiting for the server to indicate it
is done.</p>
<p>Our server does not yet speak the HTTP protocol, but the browser is
expecting it.</p>
</div>
<p>Kill your server with <code class="docutils literal"><span class="pre">ctrl-c</span></code> (the keyboard interrupt) and you should see
some printed content in your browser:</p>
<div class="build container">
<div class="highlight-http"><div class="highlight"><pre><span class="nf">GET</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:10000</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:22.0) Gecko/20100101 Firefox/22.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">DNT</span><span class="o">:</span> <span class="l">1</span>
<span class="na">Cookie</span><span class="o">:</span> <span class="l">__utma=111872281.383966302.1364503233.1364503233.1364503233.1; __utmz=111872281.1364503233.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); csrftoken=uiqj579iGRbReBHmJQNTH8PFfAz2qRJS</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">max-age=0</span>
</pre></div>
</div>
<p>Your server is simply echoing what it receives, so this is an <em>HTTP
Request</em> as sent by your browser.</p>
</div>
<p>When working on HTTP applications, it&#8217;s nice to be able to see all this going back
and forth.</p>
<div class="build container">
<p>Good browsers support this with a set of developer tools built-in.</p>
<ul class="build simple">
<li>firefox -&gt; ctrl-shift-K or cmd-opt-K (os X)</li>
<li>safari -&gt; enable in preferences:advanced then cmd-opt-i</li>
<li>chrome -&gt; ctrl-shift-i or cmd-opt-i (os X)</li>
<li>IE (7.0+) -&gt; F12 or tools menu -&gt; developer tools</li>
</ul>
<p>The &#8216;Net(work)&#8217; pane of these tools can show you both request and response,
headers and all. Very useful.</p>
</div>
<p class="centered"><strong>Let&#8217;s take a quick look</strong></p>
<p>Sometimes you need or want to debug http requests that are not going through
your browser.</p>
<div class="build container">
<p>Or perhaps you need functionality that is not supported by in-browser tools
(request munging, header mangling, decryption of https request/responses)</p>
<p>Then it might be time for an HTTP debugging proxy:</p>
<ul class="build simple">
<li>windows: <a class="reference external" href="http://www.fiddler2.com/fiddler2/">http://www.fiddler2.com/fiddler2/</a></li>
<li>win/osx/linux: <a class="reference external" href="http://www.charlesproxy.com/">http://www.charlesproxy.com/</a></li>
</ul>
<p>We won&#8217;t cover any of these tools here today.  But you can check them out
when you have the time.</p>
</div>
</div>
<div class="section" id="step-1-basic-http-protocol">
<h3>Step 1: Basic HTTP Protocol<a class="headerlink" href="#step-1-basic-http-protocol" title="Permalink to this headline">¶</a></h3>
<p>In HTTP 1.0, the only required line in an HTTP request is this:</p>
<div class="highlight-http"><div class="highlight"><pre>GET /path/to/index.html HTTP/1.0&lt;CRLF&gt;
&lt;CRLF&gt;
</pre></div>
</div>
<div class="build container">
<p>As virtual hosting grew more common, that was not enough, so HTTP 1.1 adds
a single required <em>header</em>, <strong>Host</strong>:</p>
<div class="highlight-http"><div class="highlight"><pre>GET /path/to/index.html HTTP/1.1&lt;CRLF&gt;
Host: www.mysite1.com:80&lt;CRLF&gt;
&lt;CRLF&gt;
</pre></div>
</div>
</div>
<p>In both HTTP 1.0 and 1.1, a proper response consists of an intial line,
followed by optional headers, a single blank line, and then optionally a
response body:</p>
<div class="build container">
<div class="highlight-http"><div class="highlight"><pre>HTTP/1.1 200 OK&lt;CRLF&gt;
Content-Type: text/plain&lt;CRLF&gt;
&lt;CRLF&gt;
this is a pretty minimal response
</pre></div>
</div>
<p>Let&#8217;s update our server to return such a response.</p>
</div>
<p>Begin by implementing a new function in your <code class="docutils literal"><span class="pre">http_server.py</span></code> script called
<cite>response_ok</cite>.</p>
<div class="build container">
<p>It can be super-simple for now.  We&#8217;ll improve it later.</p>
<div class="container">
<p>It needs to return our minimal response from above:</p>
<div class="highlight-http"><div class="highlight"><pre>HTTP/1.1 200 OK&lt;CRLF&gt;
Content-Type: text/plain&lt;CRLF&gt;
&lt;CRLF&gt;
this is a pretty minimal response
</pre></div>
</div>
</div>
<p><strong>Remember, &lt;CRLF&gt; is a placeholder for the</strong> <code class="docutils literal"><span class="pre">\r\n</span></code> <strong>character sequence</strong></p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">response_ok</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;returns a basic HTTP response&quot;&quot;&quot;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;HTTP/1.1 200 OK&quot;</span><span class="p">)</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;Content-Type: text/plain&quot;</span><span class="p">)</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;this is a pretty minimal response&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
</pre></div>
</div>
<p>Did you remember that sockets only accept bytes?</p>
<p>We&#8217;ve now implemented a function that is tested by our tests. Let&#8217;s run them
again:</p>
<div class="build container">
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python tests.py
<span class="o">[</span>...<span class="o">]</span>
----------------------------------------------------------------------
Ran <span class="m">10</span> tests in 0.002s

FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span>3, <span class="nv">errors</span><span class="o">=</span>3<span class="o">)</span>
</pre></div>
</div>
<p>Great!  We&#8217;ve now got 4 tests that pass.  Good work.</p>
</div>
<p>Next, we need to rebuild the server loop from our echo server for it&#8217;s new
purpose:</p>
<div class="build container">
<p>It should now wait for an incoming request to be <em>finished</em>, <em>then</em> send a
response back to the client.</p>
<p>The response it sends can be the result of calling our new <code class="docutils literal"><span class="pre">response_ok</span></code>
function for now.</p>
<p>We could also bump up the <code class="docutils literal"><span class="pre">recv</span></code> buffer size to something more reasonable
for HTTP traffic, say 1024.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># ...</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;waiting for a connection&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
        <span class="n">conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>  <span class="c"># blocking</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;connection - {0}:{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">addr</span><span class="p">),</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;sending response&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">response_ok</span><span class="p">()</span>
            <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c"># ...</span>
</pre></div>
</div>
<p>Once you&#8217;ve got that set, restart your server:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python http_server.py
</pre></div>
</div>
<div class="build container">
<p>Then you can re-run your tests:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python tests.py
<span class="o">[</span>...<span class="o">]</span>
----------------------------------------------------------------------
Ran <span class="m">10</span> tests in 0.003s

FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span>2, <span class="nv">errors</span><span class="o">=</span>3<span class="o">)</span>
</pre></div>
</div>
<p>Five tests now pass!</p>
</div>
</div>
<div class="section" id="step-2-handling-http-methods">
<h3>Step 2: Handling HTTP Methods<a class="headerlink" href="#step-2-handling-http-methods" title="Permalink to this headline">¶</a></h3>
<p>Every HTTP request <strong>must</strong> begin with a single line, broken by whitespace into
three parts:</p>
<div class="highlight-http"><div class="highlight"><pre><span class="nf">GET</span> <span class="nn">/path/to/index.html</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>
</div>
<div class="build container">
<p>The three parts are the <em>method</em>, the <em>URI</em>, and the <em>protocol</em></p>
<p>Let&#8217;s look at each in turn.</p>
</div>
<p><strong>GET</strong> <code class="docutils literal"><span class="pre">/path/to/index.html</span> <span class="pre">HTTP/1.1</span></code></p>
<ul class="build simple">
<li>Every HTTP request must start with a <em>method</em></li>
<li>There are four main HTTP methods:<ul class="build">
<li>GET</li>
<li>POST</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
</li>
<li>There are others, notably HEAD, but you won&#8217;t see them too much</li>
</ul>
<p>These four methods are mapped to the four basic steps (<em>CRUD</em>) of persistent
storage:</p>
<ul class="build simple">
<li>POST = Create</li>
<li>GET = Read</li>
<li>PUT = Update</li>
<li>DELETE = Delete</li>
</ul>
<p>HTTP methods can be categorized as <strong>safe</strong> or <strong>unsafe</strong>, based on whether
they might change something on the server:</p>
<div class="build container">
<ul class="build simple">
<li>Safe HTTP Methods<ul>
<li>GET</li>
</ul>
</li>
<li>Unsafe HTTP Methods<ul>
<li>POST</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
</li>
</ul>
<p>This is a <em>normative</em> distinction, which is to say <strong>be careful</strong></p>
</div>
<p>HTTP methods can be categorized as <strong>idempotent</strong>.</p>
<div class="build container">
<p>This means that a given request will always have the same result:</p>
<ul class="build simple">
<li>Idempotent HTTP Methods<ul>
<li>GET</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
</li>
<li>Non-Idempotent HTTP Methods<ul>
<li>POST</li>
</ul>
</li>
</ul>
<p>Again, <em>normative</em>. The developer is responsible for ensuring that it is true.</p>
</div>
<p>Let&#8217;s keep things simple, our server will only respond to <em>GET</em> requests.</p>
<div class="build container">
<p>We need to create a function that parses a request and determines if we can
respond to it: <code class="docutils literal"><span class="pre">parse_request</span></code>.</p>
<p>If the request method is not <em>GET</em>, our method should raise an error</p>
<p>Remember, although a request is more than one line long, all we care about
here is the first line</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">first_line</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">method</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">protocol</span> <span class="o">=</span> <span class="n">first_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s">&quot;GET&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;We only accept GET&quot;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;request is okay&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</pre></div>
</div>
<p>We&#8217;ll also need to update the server code. It should</p>
<ul class="build simple">
<li>save the request as it comes in</li>
<li>check the request using our new function</li>
<li>send an OK response if things go well</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># ...</span>
<span class="n">conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span> <span class="c"># blocking</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;connection - {0}:{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">addr</span><span class="p">),</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
    <span class="n">request</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">request</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf8&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="n">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;sending response&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response_ok</span><span class="p">()</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c"># ...</span>
</pre></div>
</div>
<p>Quit and restart your server now that you&#8217;ve updated the code:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python http_server.py
</pre></div>
</div>
<div class="build container">
<p>At this point, we should have seven tests passing:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python tests.py
Ran <span class="m">10</span> tests in 0.002s

FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span>1, <span class="nv">errors</span><span class="o">=</span>2<span class="o">)</span>
</pre></div>
</div>
</div>
<p>The server quit during the tests, but an HTTP request from the browser should
work fine now.</p>
<div class="build container">
<p>Restart the server and reload your browser.  You should see your OK
response.</p>
<p>We can use the <code class="docutils literal"><span class="pre">simple_client.py</span></code> script in our resources to test our
error condition.  In a second terminal window run the script like so:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python simple_client.py &quot;POST / HTTP/1.0\r\n\r\n&quot;
</pre></div>
</div>
<p>This should cause the server to crash.</p>
</div>
</div>
<div class="section" id="step-3-error-responses">
<h3>Step 3: Error Responses<a class="headerlink" href="#step-3-error-responses" title="Permalink to this headline">¶</a></h3>
<p>Okay, so the outcome there was pretty ugly. The client went off the rails, and
our server has terminated as well.</p>
<div class="build container">
<p class="centered"><strong>why?</strong></p>
<p>The HTTP protocol allows us to handle errors like this more gracefully.</p>
<p class="centered"><strong>Enter the Response Code</strong></p>
</div>
<p><code class="docutils literal"><span class="pre">HTTP/1.1</span></code> <strong>200 OK</strong></p>
<p>All HTTP responses must include a <strong>response code</strong> indicating the outcome of
the request.</p>
<div class="build container">
<ul class="build simple">
<li>1xx (HTTP 1.1 only) - Informational message</li>
<li>2xx - Success of some kind</li>
<li>3xx - Redirection of some kind</li>
<li>4xx - Client Error of some kind</li>
<li>5xx - Server Error of some kind</li>
</ul>
<p>The text bit makes the code more human-readable</p>
</div>
<p>There are certain HTTP response codes you are likely to see (and use) most
often:</p>
<div class="build container">
<ul class="build simple">
<li><code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code> - Everything is good</li>
<li><code class="docutils literal"><span class="pre">301</span> <span class="pre">Moved</span> <span class="pre">Permanently</span></code> - You should update your link</li>
<li><code class="docutils literal"><span class="pre">304</span> <span class="pre">Not</span> <span class="pre">Modified</span></code> - You should load this from cache</li>
<li><code class="docutils literal"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code> - You&#8217;ve asked for something that doesn&#8217;t exist</li>
<li><code class="docutils literal"><span class="pre">500</span> <span class="pre">Internal</span> <span class="pre">Server</span> <span class="pre">Error</span></code> - Something bad happened</li>
</ul>
<p>Do not be afraid to use other, less common codes in building good apps.
There are a lot of them for a reason.</p>
<p>See <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</a></p>
</div>
<p>Luckily, there&#8217;s an error code that is tailor-made for this situation.</p>
<div class="build container">
<p>The client has made a request using a method we do not support</p>
<p><code class="docutils literal"><span class="pre">405</span> <span class="pre">Method</span> <span class="pre">Not</span> <span class="pre">Allowed</span></code></p>
<p>Let&#8217;s add a new function that returns this error code. It should be called
<code class="docutils literal"><span class="pre">response_method_not_allowed</span></code></p>
<p>Remember, it must be a complete HTTP Response with the correct <em>code</em></p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">response_method_not_allowed</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;returns a 405 Method Not Allowed response&quot;&quot;&quot;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;HTTP/1.1 405 Method Not Allowed&quot;</span><span class="p">)</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
</pre></div>
</div>
<p>Again, we&#8217;ll need to update the server to handle this error condition
correctly.  It should</p>
<ul class="build simple">
<li>catch the exception raised by the <code class="docutils literal"><span class="pre">parse_request</span></code> function</li>
<li>create our new error response as a result</li>
<li>if no exception is raised, then create the OK response</li>
<li>return the generated response to the user</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># ...</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">request</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf8&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
        <span class="k">break</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response_method_not_allowed</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response_ok</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;sending response&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf8&#39;</span><span class="p">))</span>
<span class="c"># ...</span>
</pre></div>
</div>
<p>Start your server (or restart it if by some miracle it&#8217;s still going).</p>
<div class="build container">
<p>Then run the tests again:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python tests.py
[...]
Ran 10 tests in 0.002s

OK
</pre></div>
</div>
<p>Wahoo! All our tests are passing. That means we are done writing code for
now.</p>
</div>
</div>
<div class="section" id="step-4-serving-resources">
<h3>Step 4: Serving Resources<a class="headerlink" href="#step-4-serving-resources" title="Permalink to this headline">¶</a></h3>
<p>We&#8217;ve got a very simple server that accepts a request and sends a response.
But what happens if we make a different request?</p>
<div class="build container">
<div class="container">
<p>In your web browser, enter the following URL:</p>
<div class="highlight-python"><div class="highlight"><pre>http://localhost:10000/page
</pre></div>
</div>
</div>
<div class="container">
<p>What happened? What happens if you use this URL:</p>
<div class="highlight-python"><div class="highlight"><pre>http://localhost:10000/section/page?
</pre></div>
</div>
</div>
</div>
<p>We expect different urls to result in different responses.</p>
<div class="build container">
<p>Each separate <em>path</em> provided should map to a <em>resource</em></p>
<p>But this isn&#8217;t happening with our server, for obvious reasons.</p>
<p>It brings us back to the second element of that first line of an HTTP
request.</p>
<p class="centered"><strong>The Return of the URI</strong></p>
</div>
<p><code class="docutils literal"><span class="pre">GET</span></code> <strong>/path/to/index.html</strong> <code class="docutils literal"><span class="pre">HTTP/1.1</span></code></p>
<ul class="build simple">
<li>Every HTTP request must include a <strong>URI</strong> used to determine the <strong>resource</strong> to
be returned</li>
<li>URI??
<a class="reference external" href="http://stackoverflow.com/questions/176264/whats-the-difference-between-a-uri-and-a-url/1984225#1984225">http://stackoverflow.com/questions/176264/whats-the-difference-between-a-uri-and-a-url/1984225#1984225</a></li>
<li>Resource?  Files (html, img, .js, .css), but also:<ul class="build">
<li>Dynamic scripts</li>
<li>Raw data</li>
<li>API endpoints</li>
</ul>
</li>
</ul>
<p>Our <code class="docutils literal"><span class="pre">parse_request</span></code> method actually already finds the <code class="docutils literal"><span class="pre">uri</span></code> in the first
line of a request</p>
<div class="build container">
<p>All we need to do is update the method so that it <em>returns</em> that uri</p>
<p>Then we can use it.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">first_line</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">method</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">protocol</span> <span class="o">=</span> <span class="n">first_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s">&quot;GET&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;We only accept GET&quot;</span><span class="p">)</span>
    <span class="k">print</span> <span class="o">&gt;&gt;</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#39;request is okay&#39;</span>
    <span class="c"># add the following line:</span>
    <span class="k">return</span> <span class="n">uri</span>
</pre></div>
</div>
<p>Now we can update our server code so that it uses the return value of
<code class="docutils literal"><span class="pre">parse_request</span></code>.</p>
<div class="build container">
<p>That&#8217;s a pretty simple change:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="n">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>  <span class="c"># update this line</span>
<span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response_method_not_allowed</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c"># and modify this block</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">content</span><span class="p">,</span> <span class="n">mime_type</span> <span class="o">=</span> <span class="n">resolve_uri</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">response_not_found</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">response_ok</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">mime_type</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="homework">
<h2>Homework<a class="headerlink" href="#homework" title="Permalink to this headline">¶</a></h2>
<div class="left container">
<p>You may have noticed that we just added calls to functions that don&#8217;t yet
exist</p>
<div class="build container">
<p>It&#8217;s a program that shows you what you want to do, but won&#8217;t actually
run.</p>
<p>For your homework this week you will create these functions, completing
the HTTP server.</p>
<p>Your starting point will be what we&#8217;ve made here in class.</p>
<p>I&#8217;ve added a directory to <code class="docutils literal"><span class="pre">resources/session02</span></code> called <code class="docutils literal"><span class="pre">homework</span></code>.</p>
<p>In it, you&#8217;ll find this <code class="docutils literal"><span class="pre">http_server.py</span></code> file we&#8217;ve just written in
class.</p>
<p>That file also contains enough stub code for the missing functions to
let the server run.</p>
<p>And there are more tests for you to make pass!</p>
</div>
</div>
<div class="section" id="one-step-at-a-time">
<h3>One Step At A Time<a class="headerlink" href="#one-step-at-a-time" title="Permalink to this headline">¶</a></h3>
<p>Take the following steps one at a time. Run the tests in
<code class="docutils literal"><span class="pre">assignments/session02/homework</span></code> between to ensure that you are getting it
right.</p>
<ul class="build simple">
<li>Complete the stub <code class="docutils literal"><span class="pre">resolve_uri</span></code> function so that it handles looking up
resources on disk using the URI returned by <code class="docutils literal"><span class="pre">parse_request</span></code>.</li>
<li>Make sure that if the URI does not map to a file that exists, it raises an
appropriate error for our server to handle.</li>
<li>Complete the <code class="docutils literal"><span class="pre">response_not_found</span></code> function stub so that it returns a 404
response.</li>
<li>Update <code class="docutils literal"><span class="pre">response_ok</span></code> so that it uses the values returned by <code class="docutils literal"><span class="pre">resolve_uri</span></code>
by the URI. (these have already been added to the function signature)</li>
<li>You&#8217;ll plug those values into the response you generate in the way required
by the protocol</li>
</ul>
</div>
<div class="section" id="http-headers">
<h3>HTTP Headers<a class="headerlink" href="#http-headers" title="Permalink to this headline">¶</a></h3>
<p>Along the way, you&#8217;ll discover that simply returning the content of a file as
an HTTP response body is insufficient. Different <em>types</em> of content need to
be identified to your browser</p>
<div class="build container">
<p>We can fix this by passing information about exactly what we are returning
as part of the response.</p>
<p>HTTP provides for this type of thing with the generic idea of <em>Headers</em></p>
</div>
</div>
<div class="section" id="id1">
<h3>HTTP Headers<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Both requests and responses can contain <strong>headers</strong> of the form <code class="docutils literal"><span class="pre">Name:</span> <span class="pre">Value</span></code></p>
<div class="build container">
<ul class="build simple">
<li>HTTP 1.0 has 16 valid headers, 1.1 has 46</li>
<li>Any number of spaces or tabs may separate the <em>name</em> from the <em>value</em></li>
<li>If a header line starts with spaces or tabs, it is considered part of the
value for the previous header</li>
<li>Header <em>names</em> are <strong>not</strong> case-sensitive, but <em>values</em> may be</li>
</ul>
<p>read more about HTTP headers: <a class="reference external" href="http://www.cs.tut.fi/~jkorpela/http.html">http://www.cs.tut.fi/~jkorpela/http.html</a></p>
</div>
</div>
<div class="section" id="content-type-header">
<h3>Content-Type Header<a class="headerlink" href="#content-type-header" title="Permalink to this headline">¶</a></h3>
<p>A very common header used in HTTP responses is <code class="docutils literal"><span class="pre">Content-Type</span></code>. It tells the
client what to expect.</p>
<div class="build container">
<ul class="build simple">
<li>uses <strong>mime-type</strong> (Multi-purpose Internet Mail Extensions)</li>
<li>foo.jpeg - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">image/jpeg</span></code></li>
<li>foo.png - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">image/png</span></code></li>
<li>bar.txt - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">text/plain</span></code></li>
<li>baz.html - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">text/html</span></code></li>
</ul>
<p>There are <em>many</em> mime-type identifiers:
<a class="reference external" href="http://www.webmaster-toolkit.com/mime-types.shtml">http://www.webmaster-toolkit.com/mime-types.shtml</a></p>
</div>
</div>
<div class="section" id="mapping-mime-types">
<h3>Mapping Mime-types<a class="headerlink" href="#mapping-mime-types" title="Permalink to this headline">¶</a></h3>
<p>By mapping a given file to a mime-type, we can write a header.</p>
<div class="build container">
<p>The standard lib module <code class="docutils literal"><span class="pre">mimetypes</span></code> does just this.</p>
<p>We can guess the mime-type of a file based on the filename or map a file
extension to a type:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mimetypes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="s">&#39;file.txt&#39;</span><span class="p">)</span>
<span class="go">(&#39;text/plain&#39;, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimetypes</span><span class="o">.</span><span class="n">types_map</span><span class="p">[</span><span class="s">&#39;.txt&#39;</span><span class="p">]</span>
<span class="go">&#39;text/plain&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="resolving-a-uri">
<h3>Resolving a URI<a class="headerlink" href="#resolving-a-uri" title="Permalink to this headline">¶</a></h3>
<p>Your <code class="docutils literal"><span class="pre">resolve_uri</span></code> function will need to accomplish the following tasks:</p>
<ul class="build simple">
<li>It should take a URI as the sole argument</li>
<li>It should map the pathname represented by the URI to a filesystem location.</li>
<li>It should have a &#8216;home directory&#8217;, and look only in that location.</li>
<li>If the URI is a directory, it should return a plain-text listing of the
directory contents and the mimetype <code class="docutils literal"><span class="pre">text/plain</span></code>.</li>
<li>If the URI is a file, it should return the contents of that file and its
correct mimetype.</li>
<li>If the URI does not map to a real location, it should raise an exception
that the server can catch to return a 404 response.</li>
</ul>
</div>
<div class="section" id="use-your-tests">
<h3>Use Your Tests<a class="headerlink" href="#use-your-tests" title="Permalink to this headline">¶</a></h3>
<p>One of the benefits of test-driven development is that the tests that are
failing should tell you what code you need to write.</p>
<div class="build container">
<p>As you work your way through the steps outlined above, look at your tests.
Write code that makes them pass.</p>
<p>If all the tests in <code class="docutils literal"><span class="pre">assignments/session02/tests.py</span></code> are passing, you&#8217;ve
completed the assignment.</p>
</div>
</div>
<div class="section" id="submitting-your-homework">
<h3>Submitting Your Homework<a class="headerlink" href="#submitting-your-homework" title="Permalink to this headline">¶</a></h3>
<p>To submit your homework:</p>
<div class="build container">
<ul class="build simple">
<li>Do your work in the <code class="docutils literal"><span class="pre">assignments/session02</span></code> directory of <strong>your fork</strong> of
the class respository</li>
<li>When you have all tests passing, push your work to <strong>your fork</strong> in github.</li>
<li>Using the github web interface, send me a pull request.</li>
</ul>
<p>I will review your work when I receive your pull requests, make comments on
it there, and then close the pull request.</p>
</div>
</div>
<div class="section" id="a-few-steps-further">
<h3>A Few Steps Further<a class="headerlink" href="#a-few-steps-further" title="Permalink to this headline">¶</a></h3>
<p>If you are able to finish the above in less than 4-6 hours, consider taking on
one or more of the following challenges:</p>
<ul class="build simple">
<li>Format directory listings as HTML, so you can link to files.</li>
<li>Add a GMT <code class="docutils literal"><span class="pre">Date:</span></code> header in the proper format (RFC-1123) to responses.
<em>hint: see email.utils.formatdate in the python standard library</em></li>
<li>Add a <code class="docutils literal"><span class="pre">Content-Length:</span></code> header for <code class="docutils literal"><span class="pre">OK</span></code> responses that provides a
correct value.</li>
<li>Protect your server against errors by providing, and using, a function that
returns a <code class="docutils literal"><span class="pre">500</span> <span class="pre">Internal</span> <span class="pre">Server</span> <span class="pre">Error</span></code> response.</li>
<li>Instead of returning the python script in <code class="docutils literal"><span class="pre">webroot</span></code> as plain text, execute
the file and return the results as HTML.</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Session 02</a><ul>
<li><a class="reference internal" href="#the-languages-computers-speak">The Languages Computers Speak</a><ul>
<li><a class="reference internal" href="#but-first">But First</a></li>
<li><a class="reference internal" href="#what-is-a-protocol">What is a Protocol?</a></li>
<li><a class="reference internal" href="#real-protocol-examples">Real Protocol Examples</a></li>
<li><a class="reference internal" href="#smtp">SMTP</a></li>
<li><a class="reference internal" href="#pop3">POP3</a></li>
<li><a class="reference internal" href="#imap">IMAP</a></li>
<li><a class="reference internal" href="#using-imap-in-python">Using IMAP in Python</a></li>
<li><a class="reference internal" href="#what-have-we-learned">What Have We Learned?</a></li>
<li><a class="reference internal" href="#break-time">Break Time</a></li>
</ul>
</li>
<li><a class="reference internal" href="#http">HTTP</a><ul>
<li><a class="reference internal" href="#what-does-http-look-like">What does HTTP look like?</a></li>
<li><a class="reference internal" href="#implementing-http">Implementing HTTP</a></li>
<li><a class="reference internal" href="#step-1-basic-http-protocol">Step 1: Basic HTTP Protocol</a></li>
<li><a class="reference internal" href="#step-2-handling-http-methods">Step 2: Handling HTTP Methods</a></li>
<li><a class="reference internal" href="#step-3-error-responses">Step 3: Error Responses</a></li>
<li><a class="reference internal" href="#step-4-serving-resources">Step 4: Serving Resources</a></li>
</ul>
</li>
<li><a class="reference internal" href="#homework">Homework</a><ul>
<li><a class="reference internal" href="#one-step-at-a-time">One Step At A Time</a></li>
<li><a class="reference internal" href="#http-headers">HTTP Headers</a></li>
<li><a class="reference internal" href="#id1">HTTP Headers</a></li>
<li><a class="reference internal" href="#content-type-header">Content-Type Header</a></li>
<li><a class="reference internal" href="#mapping-mime-types">Mapping Mime-types</a></li>
<li><a class="reference internal" href="#resolving-a-uri">Resolving a URI</a></li>
<li><a class="reference internal" href="#use-your-tests">Use Your Tests</a></li>
<li><a class="reference internal" href="#submitting-your-homework">Submitting Your Homework</a></li>
<li><a class="reference internal" href="#a-few-steps-further">A Few Steps Further</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="session01.html"
                        title="previous chapter">Session 01</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="session03.html"
                        title="next chapter">Session 03</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/presentations/session02.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
  <h3>Slides</h3>
  <ul class="this-page-menu">
    <li><a href="../.././slides/presentations/session02.html"
           rel="nofollow">View as slides</a></li>
  </ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="session03.html" title="Session 03"
             >next</a> |</li>
        <li class="right" >
          <a href="session01.html" title="Session 01"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">UWPCE Python 200</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Course Presentations</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012-2016, Cris Ewing.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>