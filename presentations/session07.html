<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.9.1: http://docutils.sourceforge.net/" />
<meta name="version" content="S5 1.1" />
<title>Python Web Programming</title>
<link rel="stylesheet" href="ui/uw_pce_theme/pretty.css" type="text/css" />
<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="hidden" />
<!-- style sheet links -->
<script src="ui/uw_pce_theme/slides.js" type="text/javascript"></script>
<link rel="stylesheet" href="ui/uw_pce_theme/slides.css"
      type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="ui/uw_pce_theme/outline.css"
      type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="ui/uw_pce_theme/print.css"
      type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="ui/uw_pce_theme/opera.css"
      type="text/css" media="projection" id="operaFix" />
</head>
<body>
<div class="layout">
<div id="controls"></div>
<div id="currentSlide"></div>
<div id="header">

</div>
<div id="footer">
<h1>Python Web Programming</h1>
<h2><a class="reference external" href="http://github.com/cewing/training.python_web">View document source</a>.
</h2>
</div>
</div>
<div class="presentation">
<div class="slide" id="slide0">
<h1 class="title">Python Web Programming</h1>

<img alt="img/django-pony.png" class="align-left" src="img/django-pony.png" style="width: 50%;" />
<p>Session 7: Introducing Django</p>
<p class="intro-blurb right">Wherein we become 'perfectionists with deadlines'</p>
<p class="image-credit">image: <a class="reference external" href="http://djangopony.com/">http://djangopony.com/</a></p>

</div>
<div class="slide" id="full-stack-framework">
<h1>Full Stack Framework</h1>
<p>Django comes with:</p>
<ul class="incremental simple">
<li>Persistence via the <em>Django ORM</em></li>
<li>CRUD content editing via the automatic <em>Django Admin</em></li>
<li>URL Mapping via <em>urlpatterns</em></li>
<li>Templating via the <em>Django Template Language</em></li>
<li>Caching with levels of configurability</li>
<li>Internationalization via i18n hooks</li>
<li>Form rendering and handling</li>
<li>User authentication and authorization</li>
</ul>
<p class="incremental">Pretty much everything you need to make a solid website quickly</p>
</div>
<div class="slide" id="what-sets-it-apart">
<h1>What Sets it Apart?</h1>
<p>Lots of frameworks offer some of these features, if not all.</p>
<p class="incremental">What is Django's <em>killer feature</em></p>
<p class="incremental center"><strong>The Django Admin</strong></p>
</div>
<div class="slide" id="the-django-admin">
<h1>The Django Admin</h1>
<p>Works in concert with the Django ORM to provide automatic CRUD functionality</p>
<p class="incremental">You write the models, it provides the UI</p>
<p class="incremental center"><strong>Really</strong></p>
</div>
<div class="slide" id="the-pareto-principle">
<h1>The Pareto Principle</h1>
<p>The Django Admin is a great example of the Pareto Priciple, a.k.a. the 80/20
rule:</p>
<p class="incremental center"><strong>80% of the problems can be solved by 20% of the effort</strong></p>
<p class="incremental">The converse also holds true:</p>
<p class="incremental center"><strong>Fixing the last 20% of the problems will take the remaining 80% of the
effort.</strong></p>
</div>
<div class="slide" id="other-django-advantages">
<h1>Other Django Advantages</h1>
<p>Clearly the most popular full-stack Python web framework at this time</p>
<p class="incremental">Popularity translates into:</p>
<ul class="incremental simple">
<li>Active, present community</li>
<li>Plethora of good examples to be found online</li>
<li>Rich ecosystem of <em>apps</em> (encapsulated add-on functionality)</li>
</ul>
<p class="incremental center"><strong>Jobs</strong></p>
</div>
<div class="slide" id="active-development">
<h1>Active Development</h1>
<p>Django releases in the last 12+ months:</p>
<ul class="incremental simple">
<li>1.5.1 (March 2013)</li>
<li>1.5 (February 2013)</li>
<li>1.4.5 (February 2013)</li>
<li>1.3.7 (February 2013)</li>
<li>1.4.3 (December 2012)</li>
<li>1.3.5 (December 2012)</li>
<li>1.4.2 (November 2012)</li>
<li>1.3.3 (August 2012)</li>
<li>1.4.1 (July 2012)</li>
<li>1.3.2 (July 2012)</li>
<li>1.4 (March 2012)</li>
</ul>
</div>
<div class="slide" id="great-documentation">
<h1>Great Documentation</h1>
<p>Thorough, readable, and discoverable.</p>
<p class="incremental">Led the way to better documentation for all Python</p>
<p class="incremental"><a class="reference external" href="https://readthedocs.org/">Read The Docs</a> - built in connection with
Django, sponsored by the Django Software Foundation.</p>
<p class="incremental">Write documentation as part of your python package, and render new versions of
that documentation for every commit</p>
<p class="incremental center"><strong>this is awesome</strong></p>
</div>
<div class="slide" id="django-organization">
<h1>Django Organization</h1>
<p>A Django <em>project</em> represents a whole website:</p>
<ul class="incremental simple">
<li>global configuration settings</li>
<li>inclusion points for additional functionality</li>
<li>master list of URL endpoints</li>
</ul>
<p class="incremental">A Django <em>app</em> encapsulates a unit of functionality:</p>
<ul class="incremental simple">
<li>A blog section</li>
<li>A discussion forum</li>
<li>A content tagging system</li>
</ul>
</div>
<div class="slide" id="apps-make-up-a-project">
<h1>Apps Make Up a Project</h1>
<p class="big-centered">One <em>project</em> can (and likely will) consist of many <em>apps</em></p>
</div>
<div class="slide" id="practice-safe-development">
<h1>Practice Safe Development</h1>
<p>We'll install Django and any other packages we use with it in a virtualenv.</p>
<p class="incremental">This will ensure that it is isolated from everything else we do in class (and
vice versa)</p>
<div class="incremental container">
<p>Remember the basic format for creating a virtualenv:</p>
<pre class="small literal-block">
$ python virtualenv.py [options] &lt;ENV&gt;
&lt;or&gt;
$ virtualenv [options] &lt;ENV&gt;
</pre>
</div>
</div>
<div class="slide" id="set-up-a-virtualenv">
<h1>Set Up a VirtualEnv</h1>
<p>Start by creating your virtualenv:</p>
<pre class="literal-block">
$ python virtualenv.py djangoenv
&lt;or&gt;
$ virtualenv djangoenv
...
</pre>
<div class="incremental container">
<p>Then, activate it:</p>
<pre class="literal-block">
$ source djangoenv/bin/activate
&lt;or&gt;
C:\&gt; djangoenv\Scripts\activate
</pre>
</div>
</div>
<div class="slide" id="install-django">
<h1>Install Django</h1>
<p>Finally, install Django 1.5.1 using <cite>setuptools</cite> or <cite>pip</cite>:</p>
<pre class="small literal-block">
(djangoenv)$ pip install Django==1.5.1
Downloading/unpacking Django==1.5.1
  Downloading Django-1.5.1.tar.gz (8.0MB): 8.0MB downloaded
  Running setup.py egg_info for package Django
     changing mode of /path/to/djangoenv/bin/django-admin.py to 755
Successfully installed Django
Cleaning up...
(djangoenv)$
</pre>
</div>
<div class="slide" id="starting-a-project">
<h1>Starting a Project</h1>
<p>Everything in Django stems from the <em>project</em></p>
<p class="incremental">To get started learning, we'll create one</p>
<p class="incremental">We'll use a script installed by Django, <tt class="docutils literal"><span class="pre">django-admin.py</span></tt>:</p>
<pre class="code incremental literal-block">
(djangoenv)$ django-admin.py startproject mysite
</pre>
<p class="incremental">This will create a folder called 'mysite'.  Let's take a look at it:</p>
</div>
<div class="slide" id="project-layout">
<h1>Project Layout</h1>
<p>The folder created by <tt class="docutils literal"><span class="pre">django-admin.py</span></tt> contains the following structure:</p>
<pre class="code literal-block">
mysite/
    manage.py
    mysite/
        __init__.py
        settings.py
        urls.py
        wsgi.py
</pre>
<p class="incremental">If what you see doesn't match that, you're using an older version of Django.
Make sure you've installed 1.5.1.</p>
</div>
<div class="slide" id="what-got-created">
<h1>What Got Created</h1>
<ul class="incremental simple">
<li><strong>outer *mysite* folder</strong>: this is just a container and can be renamed or
moved at will</li>
<li><strong>inner *mysite* folder</strong>: this is your project directory. It should not be
renamed.</li>
<li><strong>__init__.py</strong>: magic file that makes <em>mysite</em> a python package.</li>
<li><strong>settings.py</strong>: file which holds configuration for your project, more soon.</li>
<li><strong>urls.py</strong>: file which holds top-level URL configuration for your project,
more soon.</li>
<li><strong>wsgi.py</strong>: binds a wsgi application created from your project to the
symbol <tt class="docutils literal">application</tt></li>
<li><strong>manage.py</strong>: a management control script.</li>
</ul>
</div>
<div class="slide" id="django-and-wsgi">
<h1>Django and WSGI</h1>
<p>If you open <tt class="docutils literal">wsgi.py</tt>, you'll see the following:</p>
<pre class="code python small literal-block">
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&quot;DJANGO_SETTINGS_MODULE&quot;</span><span class="p">,</span> <span class="s">&quot;mysite.settings&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">django.core.wsgi</span> <span class="kn">import</span> <span class="n">get_wsgi_application</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">get_wsgi_application</span><span class="p">()</span>
</pre>
<div class="incremental container">
<p>Django is pointing the python environment at your settings file and then
getting a wsgi application:</p>
<pre class="code python small literal-block">
<span class="k">def</span> <span class="nf">get_wsgi_application</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">WSGIHandler</span><span class="p">()</span>
</pre>
</div>
</div>
<div class="slide" id="the-django-wsgihandler">
<h1>The Django WSGIHandler</h1>
<pre class="code python small literal-block">
<span class="k">class</span> <span class="nc">WSGIHandler</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="c">#...</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
        <span class="c">#... set up django middleware</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c">#... build a request</span>
            <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_class</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
            <span class="c">#... handle request errors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># build a response</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="c">#... determine response status</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s">'</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status_text</span><span class="p">)</span>
        <span class="c">#... build response headers</span>
        <span class="n">response_headers</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="c">#... start a response with status and headers</span>
        <span class="n">start_response</span><span class="p">(</span><span class="n">force_str</span><span class="p">(</span><span class="n">status</span><span class="p">),</span> <span class="n">response_headers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
</pre>
</div>
<div class="slide" id="django-admin-py-and-manage-py">
<h1><em>django-admin.py</em> and <em>manage.py</em></h1>
<p><em>django-admin.py</em> provides a hook for administrative tasks and abilities:</p>
<ul class="incremental simple">
<li>creating a new project or app</li>
<li>running the development server</li>
<li>executing tests</li>
<li>entering a python interpreter</li>
<li>entering a database shell session with your database</li>
<li>much much more (run <tt class="docutils literal"><span class="pre">django-admin.py</span></tt> without an argument)</li>
</ul>
<p class="incremental"><em>manage.py</em> wraps this functionality, adding the full environment of your
project.</p>
</div>
<div class="slide" id="development-server">
<h1>Development Server</h1>
<p>At this point, you should be ready to use the development server:</p>
<pre class="literal-block">
(djangoenv)$ cd mysite
(djangoenv)$ python manage.py runserver
...
</pre>
<p class="incremental">Load <tt class="docutils literal"><span class="pre">http://localhost:8000</span></tt> in your browser.</p>
</div>
<div class="slide" id="a-blank-slate">
<h1>A Blank Slate</h1>
<p>You should see this:</p>
<img alt="img/django-start.png" class="align-center" src="img/django-start.png" style="width: 98%;" />
<p class="incremental center"><strong>Do you?</strong></p>
</div>
<div class="slide" id="connecting-a-database">
<h1>Connecting A Database</h1>
<p>Django supplies its own ORM (Object-Relational Mapper)</p>
<p class="incremental">This ORM sits on top of the DB-API implementation you choose.</p>
<p class="incremental">You must provide connection information through Django configuration.</p>
<p class="incremental">All Django configuration takes place in <tt class="docutils literal">settings.py</tt> in your project
folder.</p>
</div>
<div class="slide" id="your-database-settings">
<h1>Your Database Settings</h1>
<p>Edit your <tt class="docutils literal">settings.py</tt> to match:</p>
<pre class="code python small literal-block">
<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'default'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'ENGINE'</span><span class="p">:</span> <span class="s">'django.db.backends.sqlite3'</span><span class="p">,</span>
        <span class="s">'NAME'</span><span class="p">:</span> <span class="s">'mysite.db'</span><span class="p">,</span>
        <span class="c"># The following settings are not used with sqlite3:</span>
        <span class="s">'USER'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
        <span class="s">'PASSWORD'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
        <span class="s">'HOST'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
        <span class="s">'PORT'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
</div>
<div class="slide" id="django-and-your-database">
<h1>Django and Your Database</h1>
<p>Django's ORM provides a layer of <em>abstraction</em> between you and SQL</p>
<p class="incremental">You write Python <em>models</em> describing the object that make up your system.</p>
<p class="incremental">The ORM handles converting data from these objects into SQL statements (and
back)</p>
<p class="incremental">We'll learn much more about this in a bit</p>
</div>
<div class="slide" id="core-django-apps">
<h1>Core Django <em>Apps</em></h1>
<p>Django already includes some <em>apps</em> for you.</p>
<div class="incremental container">
<p>They're in <tt class="docutils literal">settings.py</tt> in the <tt class="docutils literal">INSTALLED_APPS</tt> setting:</p>
<pre class="code python small literal-block">
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
    <span class="s">'django.contrib.sites'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="c"># 'django.contrib.admin',</span>
    <span class="c"># Uncomment the next line to enable admin documentation:</span>
    <span class="c"># 'django.contrib.admindocs',</span>
<span class="p">)</span>
</pre>
</div>
</div>
<div class="slide" id="creating-the-database">
<h1>Creating the Database</h1>
<p>These <em>apps</em> define models of their own, tables must be created.</p>
<div class="incremental container">
<p>You make them by running the <tt class="docutils literal">syncdb</tt> management command:</p>
<pre class="small literal-block">
(djangoenv)$ python manage.py syncdb
Creating tables ...
Creating table auth_permission
Creating table auth_group_permissions
Creating table auth_group
...
You just installed Django's auth system, ...
Would you like to create one now? (yes/no):
</pre>
</div>
<p class="incremental">Add your first user at this prompt (remember the password)</p>
</div>
<div class="slide" id="our-class-app">
<h1>Our Class App</h1>
<p>We are going to build an <em>app</em> to add to our <em>project</em>. To start with our app
will:</p>
<ul class="incremental simple">
<li>allow a user to create and edit blog posts</li>
<li>allow a user to define categories</li>
<li>allow a user to place a post in one or more categories</li>
</ul>
<p class="incremental">As stated above, an <em>app</em> represents a unit within a system, the <em>project</em>. We
have a project, we need to create an <em>app</em></p>
</div>
<div class="slide" id="create-an-app">
<h1>Create an App</h1>
<p>This is accomplished using <tt class="docutils literal">manage.py</tt>.</p>
<p class="incremental">In your terminal, make sure you are in the <em>outer</em> mysite directory, where the
file <tt class="docutils literal">manage.py</tt> is located.  Then:</p>
<pre class="incremental literal-block">
(djangoenv)$ python manage.py startapp myblog
</pre>
</div>
<div class="slide" id="what-is-created">
<h1>What is Created</h1>
<p>This should leave you with the following structure:</p>
<pre class="small literal-block">
mysite/
    manage.py
    mysite/
        ...
    myblog/
        __init__.py
        models.py
        tests.py
        views.py
</pre>
<p class="incremental">We'll start by defining the main Python class in our blog system, a <tt class="docutils literal">Post</tt>.</p>
</div>
<div class="slide" id="django-models">
<h1>Django Models</h1>
<p>Any Python class in Django that is meant to be persisted <em>must</em> inherit from
the Django <tt class="docutils literal">Model</tt> class.</p>
<p class="incremental">This base class hooks in to the ORM functionality converting Python code to
SQL.</p>
<p class="incremental">You can override methods from the base <tt class="docutils literal">Model</tt> class to alter how this works
or write new methods to add functionality.</p>
<p class="incremental">Learn more about <a class="reference external" href="https://docs.djangoproject.com/en/1.5/topics/db/models/">models</a></p>
</div>
<div class="slide" id="our-post-model">
<h1>Our Post Model</h1>
<p>Open the <tt class="docutils literal">models.py</tt> file created in our <tt class="docutils literal">myblog</tt> package. Add the
following:</p>
<pre class="code python small literal-block">
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>

<span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
    <span class="n">created_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">modified_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">published_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre>
</div>
<div class="slide" id="model-fields">
<h1>Model Fields</h1>
<p>We've created a subclass of the Django <tt class="docutils literal">Model</tt> class and added a bunch of
attributes.</p>
<ul class="incremental simple">
<li>These attributes are all instances of <tt class="docutils literal">Field</tt> classes defined in Django</li>
<li>Field attributes on a model map to columns in a database table</li>
<li>The arguments you provide to each Field customize how it works<ul>
<li>This means <em>both</em> how it operates in Django <em>and</em> how it is defined in SQL</li>
</ul>
</li>
<li>There are arguments shared by all Field types</li>
<li>There are also arguments specific to individual types</li>
</ul>
<p class="incremental">You can read much more about <a class="reference external" href="https://docs.djangoproject.com/en/1.5/ref/models/fields/">Model Fields and options</a></p>
</div>
<div class="slide" id="field-details">
<h1>Field Details</h1>
<p>There are some features of our fields worth mentioning in specific:</p>
<p class="incremental">Notice we have no field that is designated as the <em>primary key</em></p>
<ul class="incremental simple">
<li>You <em>can</em> make a field the primary key by adding <tt class="docutils literal">primary_key=True</tt> in the
arguments</li>
<li>If you do not, Django will automatically create one. This field is always
called <tt class="docutils literal">id</tt></li>
<li>No matter what the primary key field is called, its value is always
available on a model instance as <tt class="docutils literal">pk</tt></li>
</ul>
</div>
<div class="slide" id="id1">
<h1>Field Details</h1>
<pre class="code python small literal-block">
<span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
</pre>
<p class="incremental">The required <tt class="docutils literal">max_length</tt> argument is specific to <tt class="docutils literal">CharField</tt> fields.</p>
<p class="incremental">It affects <em>both</em> the Python and SQL behavior of a field.</p>
<p class="incremental">In python, it is used to <em>validate</em> supplied values during <em>model validation</em></p>
<p class="incremental">In SQL it is used in the column definition: <tt class="docutils literal">VARCHAR(128)</tt></p>
</div>
<div class="slide" id="id2">
<h1>Field Details</h1>
<pre class="code python small literal-block">
<span class="n">text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># ...</span>
<span class="n">published_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre>
<p class="incremental">The argument <tt class="docutils literal">blank</tt> is shared across all field types. The default is
<tt class="docutils literal">False</tt></p>
<p class="incremental">This argument affects only the Python behavior of a field, determining if the
field is <em>required</em></p>
<p class="incremental">The related <tt class="docutils literal">null</tt> argument affects the SQL definition of a field: is the
column NULL or NOT NULL</p>
</div>
<div class="slide" id="id3">
<h1>Field Details</h1>
<pre class="code python small literal-block">
<span class="n">created_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">modified_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre>
<p class="incremental"><tt class="docutils literal">auto_now_add</tt> is available on all date and time fields. It sets the value
of the field to <em>now</em> when an instance is first saved.</p>
<p class="incremental"><tt class="docutils literal">auto_now</tt> is similar, but sets the value anew each time an instance is
saved.</p>
<p class="incremental">Setting either of these will cause the <tt class="docutils literal">editable</tt> attribute of a field to be
set to <tt class="docutils literal">False</tt>.</p>
</div>
<div class="slide" id="id4">
<h1>Field Details</h1>
<pre class="code python small literal-block">
<span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
</pre>
<p class="incremental">Django also models SQL <em>relationships</em> as specific field types.</p>
<p class="incremental">The required positional argument is the class of the related Model.</p>
<p class="incremental">By default, the reverse relation is implemented as the attribute
<tt class="docutils literal">&lt;fieldname&gt;_set</tt>.</p>
<p class="incremental">You can override this by providing the <tt class="docutils literal">related_name</tt> argument.</p>
</div>
<div class="slide" id="our-category-model">
<h1>Our Category Model</h1>
<p>Our app specification says that a user should be able to place a post in one
or more categories.</p>
<p class="incremental">We'll create a second Model to represent this. It should:</p>
<ul class="incremental simple">
<li>Have a unique name</li>
<li>Have a description</li>
<li>Be in a many-to-many relationship with our <tt class="docutils literal">Post</tt> model</li>
<li>Instances of <tt class="docutils literal">Category</tt> should have a <tt class="docutils literal">posts</tt> attribute that provides
access to all posts in that category</li>
<li>Instances of <tt class="docutils literal">Post</tt> should have a <tt class="docutils literal">categories</tt> attribute that provides
access to all the categories it has been placed in.</li>
</ul>
</div>
<div class="slide" id="my-solution">
<h1>My Solution</h1>
<p>Add this new Model class to <tt class="docutils literal">models.py</tt>.</p>
<p class="incremental small"><a class="reference external" href="https://docs.djangoproject.com/en/1.5/ref/models/fields/">https://docs.djangoproject.com/en/1.5/ref/models/fields/</a></p>
<div class="incremental container">
<p>Here's my model code:</p>
<pre class="code python small literal-block">
<span class="k">class</span> <span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">posts</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Post</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">related_name</span><span class="o">=</span><span class="s">'categories'</span>
    <span class="p">)</span>
</pre>
</div>
</div>
<div class="slide" id="a-word-about-development">
<h1>A Word About Development</h1>
<p>These models we've created are not going to change often. This is unusual for
a development cycle.</p>
<p class="incremental">The <tt class="docutils literal">syncdb</tt> management command only creates tables that <em>do not yet exist</em>.
It <strong>does not update tables</strong>.</p>
<p class="incremental">The <tt class="docutils literal">sqlclear &lt;appname&gt;</tt> command will print the <tt class="docutils literal">DROP TABLE</tt> statements to
remove the tables for your app.</p>
<p class="incremental">Or <tt class="docutils literal">sql &lt;appname&gt;</tt> will show the <tt class="docutils literal">CREATE TABLE</tt> statements, and you can work
out the differences and update manually.</p>
</div>
<div class="slide" id="ack">
<h1>ACK!!!</h1>
<p>That doesn't sound very nice, does it?</p>
<p class="incremental">Luckily, there is an app available for Django that helps with this: <tt class="docutils literal">South</tt></p>
<p class="incremental">South allows you to incrementally update your database in a simplified way.</p>
<p class="incremental">South supports forward, backward and data migrations.</p>
<p class="incremental">We won't have time to <a class="reference external" href="http://south.readthedocs.org/en/latest/">cover it</a> in
this class, but know it's there.</p>
</div>
<div class="slide" id="hooking-it-up">
<h1>Hooking it Up</h1>
<p>In order to use our new models, we need Django to know about our <em>app</em></p>
<p class="incremental">This is accomplished by configuration in the <tt class="docutils literal">settings.py</tt> file.</p>
<p class="incremental">Open that file now, in your editor, and find the INSTALLED_APPS setting.</p>
</div>
<div class="slide" id="installing-apps">
<h1>Installing Apps</h1>
<p>You extend Django functionality by <em>installing apps</em>. This is pretty simple:</p>
<pre class="code python small literal-block">
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
    <span class="s">'django.contrib.sites'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="c"># 'django.contrib.admin',</span>
    <span class="c"># Uncomment the next line to enable admin documentation:</span>
    <span class="c"># 'django.contrib.admindocs',</span>
    <span class="s">'myblog'</span><span class="p">,</span> <span class="c"># &lt;- YOU ADD THIS PART</span>
<span class="p">)</span>
</pre>
</div>
<div class="slide" id="setting-up-the-database">
<h1>Setting Up the Database</h1>
<p>You know what the next step will be:</p>
<pre class="code incremental literal-block">
(djangoenv)$ python manage.py syncdb
Creating tables ...
Creating table myblog_post
Creating table myblog_category_posts
Creating table myblog_category
Installing custom SQL ...
Installing indexes ...
Installed 0 object(s) from 0 fixture(s)
</pre>
<p class="incremental">Django has now created tables for our app.  How many did it create?</p>
</div>
<div class="slide" id="orm-and-sql">
<h1>ORM and SQL</h1>
<p>That third table is the SQL mechanism by which a <tt class="docutils literal">Post</tt> is related to a
<tt class="docutils literal">Category</tt>.</p>
<p class="incremental">The ORM shields us, as Python developers, from SQL intricacies.</p>
<p class="incremental">We don't need to know that a join table is needed for a ManyToMany relation.</p>
<p class="incremental">This is but one of the ways that the ORM helps us.  More soon.</p>
</div>
<div class="slide" id="break-time">
<h1>Break Time</h1>
<p class="big-centered">Let's take a break here and return in 10 minutes.</p>
</div>
<div class="slide" id="the-django-shell">
<h1>The Django Shell</h1>
<p>Django provides a management command <tt class="docutils literal">shell</tt>:</p>
<ul class="incremental simple">
<li>Shares the same <tt class="docutils literal">sys.path</tt> as your project, so all installed python
packages are present.</li>
<li>Imports the <tt class="docutils literal">settings.py</tt> file from your project, and so shares all
installed apps and other settings.</li>
<li>Handles connections to your database, so you can interact with live data
directly.</li>
</ul>
<p class="incremental">Let's explore the Model Instance API directly using this shell:</p>
<pre class="incremental literal-block">
(djangoenv)$ python manage.py shell
</pre>
</div>
<div class="slide" id="creating-instances">
<h1>Creating Instances</h1>
<p>Instances of our model can be created by simple instantiation:</p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">myblog.models</span> <span class="kn">import</span> <span class="n">Post</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;My first post&quot;</span><span class="p">,</span>
<span class="o">...</span>           <span class="n">text</span><span class="o">=</span><span class="s">&quot;This is the first post I've written&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span>
<span class="o">&lt;</span><span class="n">Post</span><span class="p">:</span> <span class="n">Post</span> <span class="nb">object</span><span class="o">&gt;</span>
</pre>
<div class="incremental container">
<p>We can also validate that our new object is okay before we try to save it:</p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">full_clean</span><span class="p">()</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="o">...</span>
<span class="n">ValidationError</span><span class="p">:</span> <span class="p">{</span><span class="s">'author'</span><span class="p">:</span> <span class="p">[</span><span class="s">u'This field cannot be null.'</span><span class="p">]}</span>
</pre>
</div>
</div>
<div class="slide" id="django-model-managers">
<h1>Django Model Managers</h1>
<p>We have to hook our <tt class="docutils literal">Post</tt> to an author, which must be a <tt class="docutils literal">User</tt>.</p>
<p class="incremental">To do this, we need to have an instance of the <tt class="docutils literal">User</tt> class.</p>
<p class="incremental">We can use the <tt class="docutils literal">User</tt> <em>model manager</em> to run table-level operations like
<tt class="docutils literal">SELECT</tt>:</p>
<p class="incremental">All Django models have a <em>manager</em>. By default it is accessed through the
<tt class="docutils literal">objects</tt> class attribute.</p>
</div>
<div class="slide" id="making-a-foreignkey-relation">
<h1>Making a ForeignKey Relation</h1>
<p>Let's use the <em>manager</em> to get an instance of the <tt class="docutils literal">User</tt> class:</p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">all_users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">all_users</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">User</span><span class="p">:</span> <span class="n">cewing</span><span class="o">&gt;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">u1</span> <span class="o">=</span> <span class="n">all_users</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">u1</span>
</pre>
<div class="incremental container">
<p>And now our instance should validate properly:</p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">full_clean</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
</pre>
</div>
</div>
<div class="slide" id="saving-new-objects">
<h1>Saving New Objects</h1>
<p>Our model has three date fields, two of which are supposed to be
auto-populated:</p>
<pre class="python class small doctest-block">
&gt;&gt;&gt; print(p1.created_date)
None
&gt;&gt;&gt; print(p1.modified_date)
None
</pre>
<div class="incremental container">
<p>When we save our post, these fields will get values assigned:</p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">created_date</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">104217</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UTC</span><span class="o">&gt;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">modified_date</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">104826</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UTC</span><span class="o">&gt;</span><span class="p">)</span>
</pre>
</div>
</div>
<div class="slide" id="updating-an-instance">
<h1>Updating An Instance</h1>
<p>Models operate much like 'normal' python objects.</p>
<div class="incremental container">
<p>To change the value of a field, simply set the instance attribute to a new
value. Call <tt class="docutils literal">save()</tt> to persist the change:</p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">title</span> <span class="o">+</span> <span class="s">&quot; (updated)&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">title</span>
<span class="s">'My first post (updated)'</span>
</pre>
</div>
</div>
<div class="slide" id="create-a-few-posts">
<h1>Create a Few Posts</h1>
<p>Let's create a few more posts so we can explore the Django model manager query
API:</p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Another post&quot;</span><span class="p">,</span>
<span class="o">...</span>           <span class="n">text</span><span class="o">=</span><span class="s">&quot;The second one created&quot;</span><span class="p">,</span>
<span class="o">...</span>           <span class="n">author</span><span class="o">=</span><span class="n">u1</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p3</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;The third one&quot;</span><span class="p">,</span>
<span class="o">...</span>           <span class="n">text</span><span class="o">=</span><span class="s">&quot;With the word 'heffalump'&quot;</span><span class="p">,</span>
<span class="o">...</span>           <span class="n">author</span><span class="o">=</span><span class="n">u1</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p4</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Posters are great decoration&quot;</span><span class="p">,</span>
<span class="o">...</span>           <span class="n">text</span><span class="o">=</span><span class="s">&quot;When you are a poor college student&quot;</span><span class="p">,</span>
<span class="o">...</span>           <span class="n">author</span><span class="o">=</span><span class="n">u1</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="mi">4</span>
</pre>
</div>
<div class="slide" id="the-django-query-api">
<h1>The Django Query API</h1>
<p>The <em>manager</em> on each model class supports a full-featured query API.</p>
<p class="incremental">API methods take keyword arguments, where the keywords are special
constructions combining field names with field <em>lookups</em>:</p>
<ul class="incremental small simple">
<li>title__exact=&quot;The exact title&quot;</li>
<li>text__contains=&quot;decoration&quot;</li>
<li>id__in=range(1,4)</li>
<li>published_date__lte=datetime.datetime.now()</li>
</ul>
<p class="incremental">Each keyword argument generates an SQL clause.</p>
</div>
<div class="slide" id="querysets">
<h1>QuerySets</h1>
<p>API methods can be divided into two basic groups: methods that return
<tt class="docutils literal">QuerySets</tt> and those that do not.</p>
<p class="incremental">The former may be chained without hitting the database:</p>
<pre class="code python small incremental literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="c">#&lt;-- no query yet</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__icontains</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">)</span> <span class="c">#&lt;-- not yet</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">text__contains</span><span class="o">=</span><span class="s">&quot;created&quot;</span><span class="p">)</span> <span class="c">#&lt;-- nope</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[(</span><span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span> <span class="c">#&lt;-- This will issue the query</span>
</pre>
<div class="incremental container">
<p>Conversely, the latter will issue an SQL query when executed.</p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="c"># immediately executes an SQL query</span>
</pre>
</div>
</div>
<div class="slide" id="querysets-and-sql">
<h1>QuerySets and SQL</h1>
<p>If you are curious, you can see the SQL that a given QuerySet will use:</p>
<pre class="code python small incremental literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="s">&quot;myblog_post&quot;</span><span class="o">.</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="s">&quot;myblog_post&quot;</span><span class="o">.</span><span class="s">&quot;title&quot;</span><span class="p">,</span>
    <span class="s">&quot;myblog_post&quot;</span><span class="o">.</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;myblog_post&quot;</span><span class="o">.</span><span class="s">&quot;author_id&quot;</span><span class="p">,</span>
    <span class="s">&quot;myblog_post&quot;</span><span class="o">.</span><span class="s">&quot;created_date&quot;</span><span class="p">,</span> <span class="s">&quot;myblog_post&quot;</span><span class="o">.</span><span class="s">&quot;modified_date&quot;</span><span class="p">,</span>
    <span class="s">&quot;myblog_post&quot;</span><span class="o">.</span><span class="s">&quot;published_date&quot;</span>
<span class="n">FROM</span> <span class="s">&quot;myblog_post&quot;</span>
<span class="n">WHERE</span> <span class="p">(</span><span class="s">&quot;myblog_post&quot;</span><span class="o">.</span><span class="s">&quot;title&quot;</span> <span class="n">LIKE</span> <span class="o">%</span><span class="n">post</span><span class="o">%</span> <span class="n">ESCAPE</span> <span class="s">'</span><span class="se">\'</span>
       <span class="n">AND</span> <span class="n">NOT</span> <span class="p">(</span><span class="s">&quot;myblog_post&quot;</span><span class="o">.</span><span class="s">&quot;text&quot;</span> <span class="n">LIKE</span> <span class="o">%</span><span class="n">created</span><span class="o">%</span> <span class="n">ESCAPE</span> <span class="s">'</span><span class="se">\'</span><span class="s"> )</span>
<span class="p">)</span>
</pre>
<p class="incremental">The SQL will vary depending on which DBAPI backend you use (yay ORM!!!)</p>
</div>
<div class="slide" id="exploring-the-queryset-api">
<h1>Exploring the QuerySet API</h1>
<p>See <a class="reference external" href="https://docs.djangoproject.com/en/1.5/ref/models/querysets">https://docs.djangoproject.com/en/1.5/ref/models/querysets</a></p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">pk</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">'created_date'</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">pk</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">'-created_date'</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">pk</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">title__contains</span><span class="o">=</span><span class="s">'post'</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">pk</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">title__contains</span><span class="o">=</span><span class="s">'post'</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">qs</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">title__contains</span><span class="o">=</span><span class="s">'post'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">qs</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">id__exact</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">pk</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">qs</span><span class="p">]</span>
<span class="p">[]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">qs</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">title__contains</span><span class="o">=</span><span class="s">'post'</span><span class="p">,</span> <span class="n">id__exact</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">pk</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">qs</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre>
</div>
<div class="slide" id="updating-via-querysets">
<h1>Updating via QuerySets</h1>
<p>You can update all selected objects at the same time.</p>
<p class="incremental">Changes are persisted without needing to call <tt class="docutils literal">save</tt>.</p>
<pre class="code python small incremental literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="n">qs</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">published_date</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">qs</span><span class="p">]</span>
<span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">django.utils.timezone</span> <span class="kn">import</span> <span class="n">UTC</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">utc</span> <span class="o">=</span> <span class="n">UTC</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">qs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">published_date</span><span class="o">=</span><span class="n">now</span><span class="p">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">published_date</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">qs</span><span class="p">]</span>
<span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">505307</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UTC</span><span class="o">&gt;</span><span class="p">),</span>
 <span class="o">...</span><span class="p">]</span>
</pre>
</div>
<div class="slide" id="testing-our-models">
<h1>Testing Our Models</h1>
<p>As with any project, we want to test our work. Django provides a testing
framework to allow this.</p>
<p class="incremental">Django supports both <em>unit tests</em> and <em>doctests</em>. I strongly suggest using
<em>unit tests</em>.</p>
<p class="incremental">You add tests for your <em>app</em> to the file <tt class="docutils literal">tests.py</tt>, which should be at the
same package level as <tt class="docutils literal">models.py</tt>.</p>
<p class="incremental">Locate and open this file in your editor.</p>
</div>
<div class="slide" id="django-testcase-classes">
<h1>Django TestCase Classes</h1>
<p><strong>SimpleTestCase</strong> is for basic unit testing with no ORM requirements</p>
<p class="incremental"><strong>TransactionTestCase</strong> is useful if you need to test transactional
actions (commit and rollback) in the ORM</p>
<p class="incremental"><strong>TestCase</strong> is used when you require ORM access and a test client</p>
<p class="incremental"><strong>LiveServerTestCase</strong> launches the django server during test runs for
front-end acceptance tests.</p>
</div>
<div class="slide" id="testing-data">
<h1>Testing Data</h1>
<p>Sometimes testing requires base data to be present. We need a User for ours.</p>
<p class="incremental">Django provides <em>fixtures</em> to handle this need.</p>
<p class="incremental">Create a directory called <tt class="docutils literal">fixtures</tt> inside your <tt class="docutils literal">myblog</tt> app directory.</p>
<p class="incremental">Copy the file <tt class="docutils literal">myblog_test_fixture.json</tt> from the class resources into this
directory, it contains users for our tests.</p>
</div>
<div class="slide" id="setting-up-our-tests">
<h1>Setting Up Our Tests</h1>
<p>Now that we have a fixture, we need to instruct our tests to use it.</p>
<div class="incremental container">
<p>Edit <tt class="docutils literal">tests.py</tt> (which comes with one test already) to look like this:</p>
<pre class="code python small literal-block">
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>

<span class="k">class</span> <span class="nc">PostTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">fixtures</span> <span class="o">=</span> <span class="p">[</span><span class="s">'myblog_test_fixture.json'</span><span class="p">,</span> <span class="p">]</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre>
</div>
</div>
<div class="slide" id="our-first-enhancement">
<h1>Our First Enhancement</h1>
<p>Look at the way our Post represents itself in the Django shell:</p>
<pre class="code python small literal-block">
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()]</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">Post</span><span class="p">:</span> <span class="n">Post</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Post</span><span class="p">:</span> <span class="n">Post</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="o">&lt;</span><span class="n">Post</span><span class="p">:</span> <span class="n">Post</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Post</span><span class="p">:</span> <span class="n">Post</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">]</span>
</pre>
<p class="incremental">Wouldn't it be nice if the posts showed their titles instead?</p>
<p class="incremental">In Django, the <tt class="docutils literal">__unicode__</tt> method is used to determine how a Model
instance represents itself.</p>
<p class="incremental">Then, calling <tt class="docutils literal">unicode(instance)</tt> gives the desired result.</p>
</div>
<div class="slide" id="write-the-test">
<h1>Write The Test</h1>
<p>Let's write a test that demonstrates our desired outcome:</p>
<pre class="code python small literal-block">
<span class="c"># add this import at the top</span>
<span class="kn">from</span> <span class="nn">myblog.models</span> <span class="kn">import</span> <span class="n">Post</span>

<span class="c"># and this test method to the PostTestCase</span>
<span class="n">test_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="s">&quot;This is a title&quot;</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">expected</span><span class="p">)</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
</pre>
</div>
<div class="slide" id="run-the-test">
<h1>Run The Test</h1>
<p>To run tests, use the <tt class="docutils literal">test</tt> management command</p>
<p class="incremental">Without arguments, it will run all TestCases it finds in all installed <em>apps</em></p>
<p class="incremental">You can pass the name of a single app to focus on those tests</p>
<p class="incremental">Quit your Django shell and in your terminal run the test we wrote:</p>
<pre class="code bash small incremental literal-block">
<span class="o">(</span>djangoenv<span class="o">)</span><span class="nv">$ </span>python manage.py <span class="nb">test </span>myblog
</pre>
</div>
<div class="slide" id="the-result">
<h1>The Result</h1>
<p>We have yet to implement this enhancement, so our test should fail:</p>
<pre class="small literal-block">
Creating test database for alias 'default'...
F
======================================================================
FAIL: test_unicode (myblog.tests.PostTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File &quot;/Users/cewing/projects/training/uw_pce/training.python_web/scripts/session07/mysite/myblog/tests.py&quot;, line 15, in test_unicode
    self.assertEqual(expected, actual)
AssertionError: 'This is a title' != u'Post object'

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (failures=1)
Destroying test database for alias 'default'...
</pre>
</div>
<div class="slide" id="make-it-pass">
<h1>Make it Pass</h1>
<p>Let's add an appropriate <tt class="docutils literal">__unicode__</tt> method to our Post class</p>
<p class="incremental">It will take <tt class="docutils literal">self</tt> as its only argument</p>
<p class="incremental">And it should return its own title as the result</p>
<p class="incremental">Go ahead and take a stab at this in <tt class="docutils literal">models.py</tt></p>
<pre class="code python small incremental literal-block">
<span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="c">#...</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
</pre>
</div>
<div class="slide" id="did-it-work">
<h1>Did It Work?</h1>
<p>Re-run the tests to see:</p>
<pre class="code bash small literal-block">
<span class="o">(</span>djangoenv<span class="o">)</span><span class="nv">$ </span>python manage.py <span class="nb">test </span>myblog
Creating <span class="nb">test </span>database <span class="k">for </span><span class="nb">alias</span> <span class="s1">'default'</span>...
.
----------------------------------------------------------------------
Ran 1 <span class="nb">test </span>in 0.007s

OK
Destroying <span class="nb">test </span>database <span class="k">for </span><span class="nb">alias</span> <span class="s1">'default'</span>...
</pre>
<p class="incremental center"><strong>YIPEEEE!</strong></p>
</div>
<div class="slide" id="repeat-the-exercise">
<h1>Repeat the Exercise</h1>
<p>Although we haven't played with it yet, our Category class could use the same
treatment, using the <tt class="docutils literal">name</tt> field.</p>
<p class="incremental">Add a CategoryTestCase to <tt class="docutils literal">tests.py</tt> with one test that shows this.</p>
<p class="incremental">Run the tests, demonstrating that you have two tests and one failure</p>
<p class="incremental">Add the appropriate method to the appropriate class in <tt class="docutils literal">models.py</tt> and
re-run the tests.</p>
</div>
<div class="slide" id="my-test">
<h1>My Test</h1>
<pre class="code python incremental literal-block">
<span class="c"># another import</span>
<span class="kn">from</span> <span class="nn">myblog.models</span> <span class="kn">import</span> <span class="n">Category</span>

<span class="c"># and the test case and test</span>
<span class="k">class</span> <span class="nc">CategoryTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="s">&quot;A Category&quot;</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">Category</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">expected</span><span class="p">)</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
</pre>
</div>
<div class="slide" id="my-method">
<h1>My Method</h1>
<pre class="code python literal-block">
<span class="k">class</span> <span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="c">#...</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</pre>
</div>
<div class="slide" id="what-to-test">
<h1>What to Test</h1>
<p>In any framework, the question arises of what to test. Much of your app's
functionality is provided by framework tools. Does that need testing?</p>
<p class="incremental">I <em>usually</em> don't write tests covering features provided directly by the
framework.</p>
<p class="incremental">I <em>do</em> write tests for functionality I add, and for places where I make
changes to how the default functionality works.</p>
<p class="incremental">This is largely a matter of style and taste (and of budget).</p>
</div>
<div class="slide" id="more-later">
<h1>More Later</h1>
<p>We've only begun to test our blog app.</p>
<p class="incremental">We'll be adding many more tests later</p>
<p class="incremental">In between, you might want to take a look at the Django testing documentation:</p>
<p class="incremental center"><a class="reference external" href="https://docs.djangoproject.com/en/1.5/topics/testing/">https://docs.djangoproject.com/en/1.5/topics/testing/</a></p>
</div>
<div class="slide" id="id5">
<h1>The Django Admin</h1>
<p>As I stated earlier, the Django admin is really Django's <em>killer feature</em></p>
<p class="incremental">To demonstrate this, we are going to set up the admin for our blog</p>
</div>
<div class="slide" id="install-the-admin">
<h1>Install the Admin</h1>
<p>The Django Admin is, itself, an <em>app</em>. It is not installed by default.</p>
<p class="incremental">Open the <tt class="docutils literal">settings.py</tt> file from our <tt class="docutils literal">mysite</tt> project package and
uncomment the admin bit:</p>
<pre class="code python incremental small literal-block">
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c"># ...</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="s">'django.contrib.admin'</span><span class="p">,</span> <span class="c"># &lt;- THIS LINE HERE</span>
    <span class="c"># Uncomment the next line to enable admin documentation:</span>
    <span class="c"># 'django.contrib.admindocs',</span>
    <span class="s">'myblog'</span><span class="p">,</span>
<span class="p">)</span>
</pre>
</div>
<div class="slide" id="add-the-admin-tables">
<h1>Add the Admin Tables</h1>
<p>As you might expect, enabling the admin alters our DB. We'll need to run
the <tt class="docutils literal">syncdb</tt> management command:</p>
<pre class="literal-block">
(djangoenv)$ python manage.py syncdb
Creating tables ...
Creating table django_admin_log
Installing custom SQL ...
Installing indexes ...
Installed 0 object(s) from 0 fixture(s)
</pre>
<p class="incremental">All set.  Now let's make it visitable</p>
</div>
<div class="slide" id="django-url-resolution">
<h1>Django URL Resolution</h1>
<p>Django too has a system for routing URLs to code: the <em>urlconf</em>.</p>
<ul class="incremental simple">
<li>A urlconf is a list of calls to the <tt class="docutils literal">django.conf.urls.url</tt> function</li>
<li>This function takes:<ul>
<li>a regexp <em>rule</em>, representing the URL</li>
<li>a <tt class="docutils literal">callable</tt> to be invoked (or a name identifying one)</li>
<li>an optional <em>name</em> kwarg, used to <em>reverse</em> the URL</li>
<li>other optional arguments we will skip for now</li>
</ul>
</li>
<li>The function returns a <em>resolver</em> that matches the request path to the
callable</li>
<li>django will load the urlconf named <tt class="docutils literal">urlpatterns</tt> that it finds in the file
named in <tt class="docutils literal">settings.ROOT_URLCONF</tt>.</li>
</ul>
</div>
<div class="slide" id="including-urls">
<h1>Including URLs</h1>
<p>Many Django add-on <em>apps</em>, like the Django Admin, come with their own urlconf</p>
<p class="incremental">It is standard to include these urlconfs by rooting them at some path in your
site.</p>
<div class="incremental container">
<p>You can do this by using the <tt class="docutils literal">include</tt> function as the callable in a
<tt class="docutils literal">url</tt> call:</p>
<pre class="code python small literal-block">
<span class="n">url</span><span class="p">(</span><span class="s">r'^forum/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'random.forum.app.urls'</span><span class="p">))</span>
</pre>
</div>
</div>
<div class="slide" id="including-the-admin">
<h1>Including the Admin</h1>
<p>We can use this to add <em>all</em> the URLs provided by the Django admin in one
stroke.</p>
<div class="incremental container">
<p>Uncomment three lines in <tt class="docutils literal">urls.py</tt>:</p>
<pre class="code python small literal-block">
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span> <span class="c">#&lt;- Uncomment these two</span>
<span class="n">admin</span><span class="o">.</span><span class="n">autodiscover</span><span class="p">()</span>             <span class="c">#&lt;-</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">''</span><span class="p">,</span>

    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r'^admin/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span> <span class="c">#&lt;- and this</span>
<span class="p">)</span>
</pre>
</div>
</div>
<div class="slide" id="using-the-development-server">
<h1>Using the Development Server</h1>
<p>We can now view the admin.  We'll use the Django development server.</p>
<p class="incremental">In your terminal, use the <tt class="docutils literal">runserver</tt> management command to start the
development server:</p>
<pre class="incremental literal-block">
(djangoenv)$ python manage.py runserver
Validating models...

0 errors found
Django version 1.4.3, using settings 'mysite.settings'
Development server is running at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
</pre>
</div>
<div class="slide" id="viewing-the-admin">
<h1>Viewing the Admin</h1>
<p>Load <tt class="docutils literal"><span class="pre">http://localhost:8000/admin/</span></tt>.  You should see this:</p>
<img alt="img/django-admin-login.png" class="align-center" src="img/django-admin-login.png" style="width: 50%;" />
<p class="incremental">Login with the name and password you created before.</p>
</div>
<div class="slide" id="the-admin-index">
<h1>The Admin Index</h1>
<p>The index will provide a list of all the installed <em>apps</em> and each model
registered.  You should see this:</p>
<img alt="img/admin_index.png" class="align-center" src="img/admin_index.png" style="width: 90%;" />
<p class="incremental">Click on <tt class="docutils literal">Users</tt>. Find yourself? Edit yourself, but <strong>don't</strong> uncheck
<tt class="docutils literal">superuser</tt>.</p>
</div>
<div class="slide" id="add-posts-to-the-admin">
<h1>Add Posts to the Admin</h1>
<p>Okay, let's add our app models to the admin.</p>
<p class="incremental">Add a new file to the <tt class="docutils literal">myblog</tt> app package: <tt class="docutils literal">admin.py</tt>. Open it and add
the following:</p>
<pre class="code python incremental literal-block">
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">myblog.models</span> <span class="kn">import</span> <span class="n">Post</span><span class="p">,</span> <span class="n">Category</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Post</span><span class="p">)</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Category</span><span class="p">)</span>
</pre>
<p class="incremental">Restart your Development server and reload the admin index</p>
</div>
<div class="slide" id="play-a-bit">
<h1>Play A Bit</h1>
<p>Visit the admin page for Posts. You should see the posts we created earlier in
the Django shell.</p>
<p class="incremental">Look at the listing of Posts. Because of our <tt class="docutils literal">__unicode__</tt> method we see a
nice title.</p>
<p class="incremental">Are there other fields you'd like to see listed?</p>
<p class="incremental">Click on a Post, note what is and is not shown.</p>
<p class="incremental">Poke at the Category admin a bit too.</p>
</div>
<div class="slide" id="next-steps">
<h1>Next Steps</h1>
<p>We've learned a great deal about Django's ORM and Models.</p>
<p class="incremental">We've also spent some time getting to know the Query API provided by model
managers and QuerySets.</p>
<p class="incremental">We've also hooked up the Django Admin and noted some shortcomings.</p>
<p class="incremental">In our next session we'll improve how the admin works for us.</p>
<p class="incremental">Then we'll put a front-end on this blog.</p>
</div>
<div class="slide" id="id6">
<h1>Break Time</h1>
<p class="big-centered">See you back soon.</p>
</div>
</div>
</body>
</html>
